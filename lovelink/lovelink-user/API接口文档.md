# 聊巴(LoveLink) - 用户服务API接口文档

## 文档说明

本文档主要描述聊巴(LoveLink)项目用户服务模块的API接口，包括接口地址、请求方式、请求参数、响应结果等信息。

- 接口基础路径: `/user`
- 服务端口: `9001`
- 数据交互格式: `JSON`
- 接口统一返回格式:
  ```json
  {
    "code": 200,       // 状态码：200成功，400失败，402未登录，403权限不足
    "message": "操作成功", // 提示信息
    "data": {}         // 返回数据，可能为对象、数组或null
  }
  ```

## 接口列表

### 1. 发送注册验证码

#### 接口信息

- 接口地址: `/user/sendCode`
- 请求方式: `POST`
- 接口描述: 发送手机验证码，用于用户注册第一步

#### 请求参数

| 参数名 | 类型   | 是否必须 | 描述                          |
| ------ | ------ | -------- | ----------------------------- |
| phone  | String | 是       | 手机号，格式：1开头的11位数字 |

#### 请求示例

```
POST /user/sendCode
Content-Type: application/json

{
  "phone": "13800138000"
}
```

#### 响应结果

- 成功响应:

```json
{
  "code": 200,
  "message": "验证码发送成功",
  "data": null
}
```

- 失败响应:

```json
{
  "code": 400,
  "message": "该手机号已被注册",
  "data": null
}
```

```json
{
  "code": 400,
  "message": "请勿频繁发送验证码，请稍后再试",
  "data": null
}
```

#### 更新记录

| 日期       | 作者   | 更新内容                 |
| ---------- | ------ | ------------------------ |
| 2025-07-08 | 振涛   | 创建发送验证码接口文档   |

---

### 2. 验证验证码

#### 接口信息

- 接口地址: `/user/verifyCode`
- 请求方式: `POST`
- 接口描述: 验证手机验证码是否正确

#### 请求参数

| 参数名 | 类型   | 是否必须 | 描述                          |
| ------ | ------ | -------- | ----------------------------- |
| phone  | String | 是       | 手机号，格式：1开头的11位数字 |
| code   | String | 是       | 验证码，必须是6位数字         |

#### 请求示例

```
POST /user/verifyCode
Content-Type: application/json

{
  "phone": "13800138000",
  "code": "123456"
}
```

#### 响应结果

- 成功响应:

```json
{
  "code": 200,
  "message": "验证码验证成功",
  "data": null
}
```

- 失败响应:

```json
{
  "code": 400,
  "message": "验证码已过期，请重新获取",
  "data": null
}
```

```json
{
  "code": 400,
  "message": "验证码错误",
  "data": null
}
```

#### 更新记录

| 日期       | 作者   | 更新内容                 |
| ---------- | ------ | ------------------------ |
| 2025-07-08 | 振涛   | 创建验证验证码接口文档   |

---

### 3. 用户注册

#### 接口信息

- 接口地址: `/user/register`
- 请求方式: `POST`
- 接口描述: 用户注册接口，支持头像上传（注册第二步）

#### 请求参数

| 参数名     | 类型         | 是否必须 | 描述                                 |
| ---------- | ------------ | -------- | ------------------------------------ |
| phone      | String       | 是       | 手机号，格式：1开头的11位数字        |
| password   | String       | 是       | 密码，长度6-20位                     |
| verifyCode | String       | 是       | 验证码，长度6位                      |
| nickname   | String       | 否       | 昵称，不超过20个字符，不填则使用默认 |
| avatar     | File(图片)   | 否       | 用户头像，不上传则使用默认头像       |

#### 请求示例

```
POST /user/register
Content-Type: multipart/form-data

phone=13800138000&password=password123&verifyCode=123456&nickname=张三
[avatar文件二进制数据]
```

#### 响应结果

- 成功响应:

```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "userId": 10001,
    "phone": "13800138000",
    "nickname": "张三",
    "gender": 0,
    "birthDate": null,
    "avatarUrl": "http://minio-server:9000/lovelink/avatar/2025/07/08/a1b2c3d4e5f6.jpg",
    "userRole": 1,
    "registerSource": 1,
    "registerTime": "2025-07-08T17:40:00",
    "lastLoginTime": null,
    "accountStatus": 1,
    "isVerified": 0,
    "isVip": 0
  }
}
```

- 失败响应:

```json
{
  "code": 400,
  "message": "验证码错误或已过期，请重新获取",
  "data": null
}
```

```json
{
  "code": 400,
  "message": "头像上传失败：文件格式不支持",
  "data": null
}
```

#### 更新记录

| 日期       | 作者   | 更新内容                       |
| ---------- | ------ | ------------------------------ |
| 2025-07-08 | 振涛   | 创建接口文档，实现基础注册功能 |
| 2025-07-08 | 振涛   | 添加头像上传功能               |
| 2025-07-08 | 振涛   | 修改为两步注册流程的第二步     |

---

## 待开发接口

### 1. 用户登录

#### 接口信息

- 接口地址: `/user/login`
- 请求方式: `POST`
- 接口描述: 用户登录接口

### 2. 获取用户信息

#### 接口信息

- 接口地址: `/user/info`
- 请求方式: `GET`
- 接口描述: 获取当前登录用户信息

### 3. 修改用户信息

#### 接口信息

- 接口地址: `/user/update`
- 请求方式: `PUT`
- 接口描述: 修改用户基本信息

### 4. 修改用户头像

#### 接口信息

- 接口地址: `/user/avatar`
- 请求方式: `POST`
- 接口描述: 修改用户头像

### 5. 修改密码

#### 接口信息

- 接口地址: `/user/password`
- 请求方式: `PUT`
- 接口描述: 修改用户密码

---

## 错误码说明

| 错误码 | 说明         |
| ------ | ------------ |
| 200    | 操作成功     |
| 400    | 操作失败     |
| 402    | 未登录       |
| 403    | 权限不足     |

---

## 接口开发规范

1. 新增接口时，请按照文档格式在对应模块下添加接口信息
2. 修改接口时，请在"更新记录"中添加修改信息
3. 接口参数和返回值应与文档保持一致
4. 接口命名遵循RESTful规范
5. 所有接口返回结果必须使用统一的Result格式 