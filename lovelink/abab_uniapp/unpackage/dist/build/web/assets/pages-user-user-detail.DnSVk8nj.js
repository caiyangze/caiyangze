function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/api-chat.BF5K77Hj.js","assets/index-BpPI9udZ.js","assets/index-DMIaa8Q1.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{_ as e,a,r as l,o as t,a2 as s,Q as o,s as n,g as c,d as i,w as u,i as d,f as r,h as f,j as v,t as _,a3 as m,k as g,A as k,l as y,m as h,F as p,H as b,X as w,C,b as L,p as x,q as F,u as I,v as D,D as U}from"./index-BpPI9udZ.js";import{getUserDetail as O,getUserPhotos as S,getUserMoments as T,checkUserFollow as K,toggleUserLike as M,toggleUserFollow as V}from"./api-user-detail.fhFDcuKa.js";const j=e({__name:"user-detail",setup(e){const j=a({nickname:"",gender:0,avatarUrl:"",birthDate:null,fan:0,countFollow:0,countLike:0,isVip:0,isVerified:0,isLiked:!1,isFollowed:!1,isOnline:!1}),E=a({age:null,workCity:"",height:null,weight:null,education:null,company:"",position:"",incomeLevel:null,maritalStatus:null,hasChildren:null,houseStatus:null,carStatus:null,selfIntroduction:"",hobby:""}),A=a([]),P=a([]),$=a([]),N=l({}),R=a(0),q=a("photos"),B=a(!1);async function H(e){try{const a=await S(e,1,20);console.log("用户相册响应:",a),200===a.code?(a.data&&a.data.records?P.value=a.data.records||[]:Array.isArray(a.data)?P.value=a.data:P.value=[],console.log("用户相册数据:",P.value)):(console.warn("获取用户相册失败:",a.message),P.value=[])}catch(a){console.error("获取用户相册失败:",a),P.value=[]}}async function Y(e){try{const a=await T(e,1,20);200===a.code&&(a.data&&a.data.records?$.value=a.data.records||[]:$.value=a.data||[])}catch(a){console.error("获取用户动态失败:",a),$.value=[]}}async function Q(e){try{if(!oe())return console.log("用户未登录，跳过关注状态检查"),void(j.value.isFollowed=!1);const a=await K(e);console.log("关注状态响应:",a),200===a.code?(j.value.isFollowed=a.data||!1,console.log("关注状态:",j.value.isFollowed)):401===a.code&&(console.log("用户未登录或token过期"),j.value.isFollowed=!1)}catch(a){console.error("获取关注状态失败:",a),j.value.isFollowed=!1}}function X(){try{return E.value&&E.value.age?E.value.age:j.value&&j.value.birthDate?function(e){if(!e)return"未知";try{const a=new Date(e);if(isNaN(a.getTime()))return"未知";const l=new Date;let t=l.getFullYear()-a.getFullYear();const s=l.getMonth()-a.getMonth();return(s<0||0===s&&l.getDate()<a.getDate())&&t--,t>0?t:"未知"}catch(a){return console.error("计算年龄失败:",a),"未知"}}(j.value.birthDate):"未知"}catch(e){return console.error("获取年龄失败:",e),"未知"}}function z(e){q.value=e}async function G(){try{const e=o(),a=e[e.length-1],l=a.options.userId||a.options.id;200===(await M(l)).code&&(j.value.isLiked=!j.value.isLiked,n({title:j.value.isLiked?"点赞成功":"取消点赞",icon:"success"}))}catch(e){console.error("点赞操作失败:",e),n({title:"操作失败",icon:"none"})}}async function J(){try{const e=o(),a=e[e.length-1],l=a.options.userId||a.options.id;if(!oe())return void n({title:"请先登录",icon:"none"});j.value.isFollowed?b({title:"取消关注",content:`确定要取消关注 ${j.value.nickname||"该用户"} 吗？`,confirmText:"取消关注",cancelText:"我再想想",confirmColor:"#ff4757",success:async e=>{e.confirm&&await W(l)}}):await W(l)}catch(e){console.error("关注操作失败:",e),n({title:"操作失败",icon:"none"})}}async function W(e){try{const a=await V(e);console.log("关注操作响应:",a),200===a.code?(j.value.isFollowed=!j.value.isFollowed,j.value.isFollowed?j.value.fan=(j.value.fan||0)+1:j.value.fan=Math.max((j.value.fan||0)-1,0),n({title:a.message||(j.value.isFollowed?"关注成功":"取消关注成功"),icon:"success"}),await async function(e){try{console.log("刷新用户详情数据...");const a=await O(e);if(200===a.code&&a.data&&a.data.records){const l=a.data.records.find((a=>a.userId==e));if(l){const e=j.value.isFollowed;j.value=Object.assign({},l,{isLiked:l.isLiked||!1,isFollowed:e,isOnline:l.isOnline||!1}),console.log("用户详情数据刷新成功，最新粉丝数:",j.value.fan)}}}catch(a){console.error("刷新用户详情失败:",a)}}(e)):401===a.code?n({title:"登录已过期，请重新登录",icon:"none"}):n({title:a.message||"操作失败",icon:"none"})}catch(a){console.error("关注操作失败:",a),n({title:"操作失败",icon:"none"})}}function Z(){w()}function ee(){C({itemList:["举报","拉黑"],success:e=>{0===e.tapIndex?n({title:"举报功能开发中",icon:"none"}):1===e.tapIndex&&n({title:"拉黑功能开发中",icon:"none"})}})}function ae(){j.value.avatarUrl="/static/common/default-avatar.png"}function le(e){const a=new Date(e),l=new Date-a;return l<6e4?"刚刚":l<36e5?Math.floor(l/6e4)+"分钟前":l<864e5?Math.floor(l/36e5)+"小时前":Math.floor(l/864e5)+"天前"}async function te(){if(j.value.userId)try{const e=await L((()=>import("./api-chat.BF5K77Hj.js")),__vite__mapDeps([0,1,2])),a=await e.canChat(j.value.userId);200===a.code?!0===a.data?x({url:`/pages/message/chat?userId=${j.value.userId}&name=${encodeURIComponent(j.value.nickname)}&avatar=${encodeURIComponent(j.value.avatarUrl||"/static/message/default-avatar.png")}`}):b({title:"提示",content:"需要互相关注才能聊天哦～",showCancel:!1,confirmText:"知道了"}):n({title:a.message||"检查聊天权限失败",icon:"none"})}catch(e){console.error("检查聊天权限失败:",e),n({title:"网络错误，请重试",icon:"none"})}else n({title:"用户信息错误",icon:"none"})}function se(){n({title:"申请介绍功能开发中",icon:"none"})}function oe(){try{const e=c("token");return e||(console.log("未找到用户token，用户可能未登录"),null)}catch(e){return console.error("获取token失败:",e),null}}return t((()=>{const e=s();R.value=e.statusBarHeight;const a=o(),l=a[a.length-1],t=l.options.userId||l.options.id;console.log("用户详情页面参数:",l.options),console.log("获取到的userId:",t),t?async function(e){try{B.value=!0;let a=null;const l=await O(e);if(console.log("getUserDetail 响应:",l),200===l.code&&l.data&&l.data.records&&(a=l.data.records.find((a=>a.userId==e)),!a&&l.data.records.length>0&&(a=l.data.records[0],console.warn("未找到指定用户ID的数据，使用第一个用户数据"))),!a)throw new Error("未找到用户数据");console.log("获取到的用户数据:",a),console.log("用户资料:",a.userProfile),console.log("用户标签:",a.userTags),j.value=Object.assign({},a,{isLiked:a.isLiked||!1,isFollowed:a.isFollowed||!1,isOnline:a.isOnline||!1}),E.value=a.userProfile||{},A.value=a.userTags||[],await Promise.all([H(e),Y(e),Q(e)])}catch(a){console.error("获取用户详情失败:",a),n({title:"加载失败，请重试",icon:"none"}),j.value={},E.value={},P.value=[],$.value=[]}finally{B.value=!1}}(t):(console.error("未获取到用户ID参数"),n({title:"用户ID参数错误",icon:"none"}))})),(e,a)=>{const l=d,t=F,s=I,o=D;return r(),i(l,{class:"user-detail-page"},{default:u((()=>[B.value?(r(),i(l,{key:0,class:"loading-container"},{default:u((()=>[f(l,{class:"loading-spinner"}),f(t,{class:"loading-text"},{default:u((()=>[v("加载中...")])),_:1})])),_:1})):(r(),i(l,{key:1,class:"main-wrapper"},{default:u((()=>[f(l,{class:"bg-layer"},{default:u((()=>[f(l,{class:"bg-gradient"}),f(l,{class:"overlay-gradient"})])),_:1}),f(l,{class:"custom-navbar",style:m({paddingTop:R.value+"px"})},{default:u((()=>[f(l,{class:"navbar-content"},{default:u((()=>[f(l,{class:"nav-left",onClick:Z},{default:u((()=>[f(t,{class:"nav-icon"},{default:u((()=>[v("←")])),_:1})])),_:1}),f(l,{class:"nav-center"},{default:u((()=>[f(t,{class:"nav-title"},{default:u((()=>[v(_(j.value&&j.value.nickname||"用户详情"),1)])),_:1})])),_:1}),f(l,{class:"nav-right",onClick:ee},{default:u((()=>[f(t,{class:"nav-icon"},{default:u((()=>[v("⋯")])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),f(o,{"scroll-y":"",class:"scroll-container",style:m({paddingTop:R.value+88+"px"})},{default:u((()=>[f(l,{class:"user-header"},{default:u((()=>[f(l,{class:"avatar-section"},{default:u((()=>[f(s,{src:j.value.avatarUrl||"/static/common/default-avatar.png",mode:"aspectFill",class:"user-avatar",onError:ae},null,8,["src"]),j.value.isOnline?(r(),i(l,{key:0,class:"online-indicator"})):g("",!0),f(l,{class:"badges"},{default:u((()=>[1===j.value.isVip?(r(),i(l,{key:0,class:"vip-badge"},{default:u((()=>[v("VIP")])),_:1})):g("",!0),1===j.value.isVerified?(r(),i(l,{key:1,class:"verified-badge"},{default:u((()=>[v("✓")])),_:1})):g("",!0)])),_:1})])),_:1}),f(l,{class:"user-info"},{default:u((()=>[f(l,{class:"name-section"},{default:u((()=>[f(t,{class:"user-name"},{default:u((()=>[v(_(j.value.nickname||"未知用户"),1)])),_:1}),f(t,{class:"user-age"},{default:u((()=>[v(_(X())+"岁",1)])),_:1}),j.value.gender&&0!==j.value.gender?(r(),i(t,{key:0,class:k(["user-gender",{"gender-male":1===j.value.gender,"gender-female":2===j.value.gender}])},{default:u((()=>[v(_(1===j.value.gender?"♂":"♀"),1)])),_:1},8,["class"])):g("",!0)])),_:1}),E.value.workCity?(r(),i(l,{key:0,class:"location-section"},{default:u((()=>[f(t,{class:"location-icon"},{default:u((()=>[v("📍")])),_:1}),f(t,{class:"location-text"},{default:u((()=>[v(_(E.value.workCity),1)])),_:1})])),_:1})):g("",!0),f(l,{class:"stats-section"},{default:u((()=>[f(l,{class:"stat-item"},{default:u((()=>[f(t,{class:"stat-count"},{default:u((()=>[v(_(j.value.fan||0),1)])),_:1}),f(t,{class:"stat-label"},{default:u((()=>[v("粉丝")])),_:1})])),_:1}),f(l,{class:"stat-item"},{default:u((()=>[f(t,{class:"stat-count"},{default:u((()=>[v(_(j.value.countFollow||0),1)])),_:1}),f(t,{class:"stat-label"},{default:u((()=>[v("关注")])),_:1})])),_:1}),f(l,{class:"stat-item"},{default:u((()=>[f(t,{class:"stat-count"},{default:u((()=>[v(_(j.value.countLike||0),1)])),_:1}),f(t,{class:"stat-label"},{default:u((()=>[v("获赞")])),_:1})])),_:1})])),_:1}),f(l,{class:"action-buttons"},{default:u((()=>[f(l,{class:k(["action-btn like-btn",{active:j.value.isLiked}]),onClick:G},{default:u((()=>[f(l,{class:"btn-icon"},{default:u((()=>[f(t,{class:"icon-text"},{default:u((()=>[v(_(j.value.isLiked?"♥":"♡"),1)])),_:1})])),_:1})])),_:1},8,["class"]),f(l,{class:k(["action-btn follow-btn",{followed:j.value.isFollowed}]),onClick:J},{default:u((()=>[f(t,{class:"btn-text"},{default:u((()=>[v(_(j.value.isFollowed?"已关注":"关注"),1)])),_:1})])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),A.value.length>0?(r(),i(l,{key:0,class:"tags-section"},{default:u((()=>[(r(!0),y(p,null,h(A.value,(e=>(r(),i(l,{class:"tag-item",key:e.id},{default:u((()=>[f(t,{class:"tag-text"},{default:u((()=>[v(_(e.tagName),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):g("",!0),f(l,{class:"tab-bar"},{default:u((()=>[f(l,{class:k(["tab-item",{active:"photos"===q.value}]),onClick:a[0]||(a[0]=e=>z("photos"))},{default:u((()=>[f(t,{class:"tab-text"},{default:u((()=>[v("相册")])),_:1})])),_:1},8,["class"]),f(l,{class:k(["tab-item",{active:"moments"===q.value}]),onClick:a[1]||(a[1]=e=>z("moments"))},{default:u((()=>[f(t,{class:"tab-text"},{default:u((()=>[v("动态")])),_:1})])),_:1},8,["class"]),f(l,{class:k(["tab-item",{active:"info"===q.value}]),onClick:a[2]||(a[2]=e=>z("info"))},{default:u((()=>[f(t,{class:"tab-text"},{default:u((()=>[v("资料")])),_:1})])),_:1},8,["class"])])),_:1}),f(l,{class:"content-container"},{default:u((()=>["photos"===q.value?(r(),i(l,{key:0,class:"photos-content"},{default:u((()=>[P.value.length>0?(r(),i(l,{key:0,class:"photo-grid"},{default:u((()=>[(r(!0),y(p,null,h(P.value,((e,a)=>(r(),i(l,{class:"photo-item",key:e.photoId,onClick:e=>function(e){const a=P.value.map((e=>e.photoUrl));U({current:e,urls:a})}(a)},{default:u((()=>[f(s,{src:e.photoUrl,mode:"aspectFill",class:"photo-image",onError:e=>function(e){N[e]=!0}(a)},null,8,["src","onError"])])),_:2},1032,["onClick"])))),128))])),_:1})):(r(),i(l,{key:1,class:"empty-state"},{default:u((()=>[f(t,{class:"empty-icon"},{default:u((()=>[v("📷")])),_:1}),f(t,{class:"empty-text"},{default:u((()=>[v("暂无照片")])),_:1})])),_:1}))])),_:1})):g("",!0),"moments"===q.value?(r(),i(l,{key:1,class:"moments-content"},{default:u((()=>[$.value.length>0?(r(),i(l,{key:0,class:"moment-list"},{default:u((()=>[(r(!0),y(p,null,h($.value,(e=>(r(),i(l,{class:"moment-item",key:e.momentId},{default:u((()=>[f(l,{class:"moment-header"},{default:u((()=>[f(l,{class:"moment-info"},{default:u((()=>[f(t,{class:"moment-time"},{default:u((()=>[v(_(le(e.createdAt)),1)])),_:2},1024),e.location?(r(),i(t,{key:0,class:"moment-location"},{default:u((()=>[v("📍 "+_(e.location),1)])),_:2},1024)):g("",!0)])),_:2},1024)])),_:2},1024),f(l,{class:"moment-content"},{default:u((()=>[f(t,{class:"moment-text"},{default:u((()=>[v(_(e.content),1)])),_:2},1024)])),_:2},1024),e.mediaList&&e.mediaList.length>0?(r(),i(l,{key:0,class:"moment-media"},{default:u((()=>{return[f(l,{class:k(["media-grid",(a=e.mediaList.length,1===a?"single":a<=4?"quad":"nine")])},{default:u((()=>[(r(!0),y(p,null,h(e.mediaList,((a,t)=>(r(),i(l,{class:"media-item",key:a.mediaId,onClick:a=>function(e,a){const l=e.map((e=>e.mediaUrl));U({current:a,urls:l})}(e.mediaList,t)},{default:u((()=>[f(s,{src:a.mediaUrl,mode:"aspectFill",class:"media-image"},null,8,["src"])])),_:2},1032,["onClick"])))),128))])),_:2},1032,["class"])];var a})),_:2},1024)):g("",!0),f(l,{class:"moment-actions"},{default:u((()=>[f(l,{class:"action-item",onClick:a=>async function(e){try{e.isLiked=!e.isLiked,e.likeCount=e.isLiked?(e.likeCount||0)+1:Math.max((e.likeCount||0)-1,0)}catch(a){console.error("动态点赞失败:",a)}}(e)},{default:u((()=>[f(t,{class:k(["action-icon",{liked:e.isLiked}])},{default:u((()=>[v(_(e.isLiked?"❤️":"🤍"),1)])),_:2},1032,["class"]),f(t,{class:"action-count"},{default:u((()=>[v(_(e.likeCount||0),1)])),_:2},1024)])),_:2},1032,["onClick"]),f(l,{class:"action-item",onClick:e=>{n({title:"评论功能开发中",icon:"none"})}},{default:u((()=>[f(t,{class:"action-icon"},{default:u((()=>[v("💬")])),_:1}),f(t,{class:"action-count"},{default:u((()=>[v(_(e.commentCount||0),1)])),_:2},1024)])),_:2},1032,["onClick"]),f(l,{class:"action-item"},{default:u((()=>[f(t,{class:"action-icon"},{default:u((()=>[v("👁")])),_:1}),f(t,{class:"action-count"},{default:u((()=>[v(_(e.viewCount||0),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(r(),i(l,{key:1,class:"empty-state"},{default:u((()=>[f(t,{class:"empty-icon"},{default:u((()=>[v("📝")])),_:1}),f(t,{class:"empty-text"},{default:u((()=>[v("暂无动态")])),_:1})])),_:1}))])),_:1})):g("",!0),"info"===q.value?(r(),i(l,{key:2,class:"info-content"},{default:u((()=>[E.value.selfIntroduction?(r(),i(l,{key:0,class:"info-section"},{default:u((()=>[f(l,{class:"section-title"},{default:u((()=>[v("💭 个人介绍")])),_:1}),f(l,{class:"intro-text"},{default:u((()=>[v(_(E.value.selfIntroduction),1)])),_:1})])),_:1})):g("",!0),f(l,{class:"info-section"},{default:u((()=>[f(l,{class:"section-title"},{default:u((()=>[v("📋 基本资料")])),_:1}),f(l,{class:"info-grid"},{default:u((()=>[E.value.height?(r(),i(l,{key:0,class:"info-item"},{default:u((()=>[f(t,{class:"info-label"},{default:u((()=>[v("身高")])),_:1}),f(t,{class:"info-value"},{default:u((()=>[v(_(E.value.height)+"cm",1)])),_:1})])),_:1})):g("",!0),E.value.weight?(r(),i(l,{key:1,class:"info-item"},{default:u((()=>[f(t,{class:"info-label"},{default:u((()=>[v("体重")])),_:1}),f(t,{class:"info-value"},{default:u((()=>[v(_(E.value.weight)+"kg",1)])),_:1})])),_:1})):g("",!0),E.value.education?(r(),i(l,{key:2,class:"info-item"},{default:u((()=>[f(t,{class:"info-label"},{default:u((()=>[v("学历")])),_:1}),f(t,{class:"info-value"},{default:u((()=>{return[v(_((e=E.value.education,{1:"高中及以下",2:"大专",3:"本科",4:"硕士",5:"博士"}[e]||"未知")),1)];var e})),_:1})])),_:1})):g("",!0),E.value.company?(r(),i(l,{key:3,class:"info-item"},{default:u((()=>[f(t,{class:"info-label"},{default:u((()=>[v("公司")])),_:1}),f(t,{class:"info-value"},{default:u((()=>[v(_(E.value.company),1)])),_:1})])),_:1})):g("",!0),E.value.position?(r(),i(l,{key:4,class:"info-item"},{default:u((()=>[f(t,{class:"info-label"},{default:u((()=>[v("职位")])),_:1}),f(t,{class:"info-value"},{default:u((()=>[v(_(E.value.position),1)])),_:1})])),_:1})):g("",!0),E.value.incomeLevel?(r(),i(l,{key:5,class:"info-item"},{default:u((()=>[f(t,{class:"info-label"},{default:u((()=>[v("收入")])),_:1}),f(t,{class:"info-value"},{default:u((()=>{return[v(_((e=E.value.incomeLevel,{1:"5K以下",2:"5K-10K",3:"10K-20K",4:"20K-50K",5:"50K以上"}[e]||"未知")),1)];var e})),_:1})])),_:1})):g("",!0),E.value.maritalStatus?(r(),i(l,{key:6,class:"info-item"},{default:u((()=>[f(t,{class:"info-label"},{default:u((()=>[v("婚姻状况")])),_:1}),f(t,{class:"info-value"},{default:u((()=>{return[v(_((e=E.value.maritalStatus,{1:"未婚",2:"离异",3:"丧偶"}[e]||"未知")),1)];var e})),_:1})])),_:1})):g("",!0),null!==E.value.hasChildren?(r(),i(l,{key:7,class:"info-item"},{default:u((()=>[f(t,{class:"info-label"},{default:u((()=>[v("子女")])),_:1}),f(t,{class:"info-value"},{default:u((()=>[v(_(E.value.hasChildren?"有":"无"),1)])),_:1})])),_:1})):g("",!0),E.value.houseStatus?(r(),i(l,{key:8,class:"info-item"},{default:u((()=>[f(t,{class:"info-label"},{default:u((()=>[v("房产")])),_:1}),f(t,{class:"info-value"},{default:u((()=>{return[v(_((e=E.value.houseStatus,{1:"租房",2:"有房贷款",3:"有房无贷款",4:"和家人同住"}[e]||"未知")),1)];var e})),_:1})])),_:1})):g("",!0),E.value.carStatus?(r(),i(l,{key:9,class:"info-item"},{default:u((()=>[f(t,{class:"info-label"},{default:u((()=>[v("车产")])),_:1}),f(t,{class:"info-value"},{default:u((()=>{return[v(_((e=E.value.carStatus,{1:"无车",2:"有车有贷款",3:"有车无贷款"}[e]||"未知")),1)];var e})),_:1})])),_:1})):g("",!0),E.value.hobby?(r(),i(l,{key:10,class:"info-item"},{default:u((()=>[f(t,{class:"info-label"},{default:u((()=>[v("爱好")])),_:1}),f(t,{class:"info-value"},{default:u((()=>[v(_(E.value.hobby),1)])),_:1})])),_:1})):g("",!0)])),_:1})])),_:1}),1===j.value.isVerified?(r(),i(l,{key:1,class:"info-section"},{default:u((()=>[f(l,{class:"section-title"},{default:u((()=>[v("✅ 认证信息")])),_:1}),f(l,{class:"cert-item"},{default:u((()=>[f(t,{class:"cert-icon"},{default:u((()=>[v("🆔")])),_:1}),f(t,{class:"cert-text"},{default:u((()=>[v("实名认证")])),_:1}),f(t,{class:"cert-status verified"},{default:u((()=>[v("已认证")])),_:1})])),_:1})])),_:1})):g("",!0)])),_:1})):g("",!0)])),_:1}),f(l,{class:"bottom-placeholder"})])),_:1},8,["style"]),f(l,{class:"bottom-actions"},{default:u((()=>[f(l,{class:"action-btn secondary",onClick:te},{default:u((()=>[f(t,{class:"btn-icon"},{default:u((()=>[v("💬")])),_:1}),f(t,{class:"btn-text"},{default:u((()=>[v("发消息")])),_:1})])),_:1}),f(l,{class:"action-btn primary",onClick:se},{default:u((()=>[f(t,{class:"btn-icon"},{default:u((()=>[v("💕")])),_:1}),f(t,{class:"btn-text"},{default:u((()=>[v("申请介绍")])),_:1})])),_:1})])),_:1})])),_:1}))])),_:1})}}},[["__scopeId","data-v-3cc681fe"]]);export{j as default};
