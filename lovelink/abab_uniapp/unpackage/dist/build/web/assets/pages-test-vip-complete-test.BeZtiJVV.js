import{_ as t,H as s,p as e,d as a,w as l,i,f as c,h as r,j as d,A as u,t as o,k as n,l as h,m as p,F as f,q as _,K as m}from"./index-BpPI9udZ.js";import{d as R,g as T,c as v,p as y}from"./vip.Ckwwy0Q7.js";const V=t({data:()=>({vipStatus:null,testResults:[],currentOrder:null}),onLoad(){this.checkVipStatus()},methods:{async checkVipStatus(){try{const t=await R();200===t.code?(this.vipStatus=t.data,this.addTestResult("VIPçŠ¶æ€æŸ¥è¯¢","æˆåŠŸèŽ·å–VIPçŠ¶æ€",!0)):this.addTestResult("VIPçŠ¶æ€æŸ¥è¯¢",t.message||"æŸ¥è¯¢å¤±è´¥",!1)}catch(t){console.error("æŸ¥è¯¢VIPçŠ¶æ€å¤±è´¥:",t),this.addTestResult("VIPçŠ¶æ€æŸ¥è¯¢","ç½‘ç»œé”™è¯¯",!1)}},async testCompleteFlow(){this.addTestResult("å®Œæ•´æµç¨‹æµ‹è¯•","å¼€å§‹æµ‹è¯•å®Œæ•´VIPè´­ä¹°æµç¨‹...",!0);try{if(200!==(await T()).code)throw new Error("èŽ·å–å¥—é¤åˆ—è¡¨å¤±è´¥");this.addTestResult("èŽ·å–å¥—é¤","æˆåŠŸèŽ·å–å¥—é¤åˆ—è¡¨",!0);const t=await v({vipType:2});if(200!==t.code)throw new Error("åˆ›å»ºè®¢å•å¤±è´¥");this.currentOrder=t.data,this.addTestResult("åˆ›å»ºè®¢å•",`è®¢å•åˆ›å»ºæˆåŠŸï¼Œè®¢å•å·ï¼š${this.currentOrder.orderNo}`,!0);const e=await y({orderId:this.currentOrder.orderId,payType:1});if(200!==e.code)throw new Error("æ”¯ä»˜å¤„ç†å¤±è´¥");this.addTestResult("æ”¯ä»˜å¤„ç†",`æ”¯ä»˜æˆåŠŸï¼Œäº¤æ˜“å·ï¼š${e.data.transactionId}`,!0),await this.checkVipStatus(),this.addTestResult("å®Œæ•´æµç¨‹","âœ… VIPè´­ä¹°æµç¨‹æµ‹è¯•å®Œæˆï¼è¯·æ£€æŸ¥æ•°æ®åº“è®°å½•",!0),s({title:"æµ‹è¯•å®Œæˆ",content:"å®Œæ•´VIPè´­ä¹°æµç¨‹æµ‹è¯•æˆåŠŸï¼\n\nè¯·æ£€æŸ¥æ•°æ®åº“ï¼š\n1. tb_vip_order è¡¨çš„è®¢å•è®°å½•\n2. tb_user è¡¨çš„ç”¨æˆ·è§’è‰²æ›´æ–°\n3. tb_wallet_transaction è¡¨çš„äº¤æ˜“è®°å½•",showCancel:!1})}catch(t){console.error("å®Œæ•´æµç¨‹æµ‹è¯•å¤±è´¥:",t),this.addTestResult("å®Œæ•´æµç¨‹",`æµ‹è¯•å¤±è´¥ï¼š${t.message}`,!1)}},testVipRecharge(){e({url:"/pages/vip/recharge"})},async testCreateOrder(){try{const t=await v({vipType:1});200===t.code?(this.currentOrder=t.data,this.addTestResult("åˆ›å»ºè®¢å•",`è®¢å•åˆ›å»ºæˆåŠŸï¼Œé‡‘é¢ï¼šÂ¥${t.data.payAmount}`,!0)):this.addTestResult("åˆ›å»ºè®¢å•",t.message||"åˆ›å»ºå¤±è´¥",!1)}catch(t){console.error("åˆ›å»ºè®¢å•å¤±è´¥:",t),this.addTestResult("åˆ›å»ºè®¢å•","ç½‘ç»œé”™è¯¯",!1)}},async testPayment(){if(this.currentOrder)try{const t=await y({orderId:this.currentOrder.orderId,payType:2});200===t.code?(this.addTestResult("æ”¯ä»˜æµ‹è¯•",`æ”¯ä»˜æˆåŠŸï¼Œäº¤æ˜“å·ï¼š${t.data.transactionId}`,!0),await this.checkVipStatus()):this.addTestResult("æ”¯ä»˜æµ‹è¯•",t.message||"æ”¯ä»˜å¤±è´¥",!1)}catch(t){console.error("æ”¯ä»˜æµ‹è¯•å¤±è´¥:",t),this.addTestResult("æ”¯ä»˜æµ‹è¯•","ç½‘ç»œé”™è¯¯",!1)}else this.addTestResult("æ”¯ä»˜æµ‹è¯•","è¯·å…ˆåˆ›å»ºè®¢å•",!1)},addTestResult(t,s,e){this.testResults.unshift({title:t,message:s,success:e,time:(new Date).toLocaleTimeString()}),this.testResults.length>10&&this.testResults.pop()},formatDate(t){if(!t)return"æ— ";return new Date(t).toLocaleString("zh-CN")}}},[["render",function(t,s,e,R,T,v){const y=_,V=i,w=m;return c(),a(V,{class:"test-page"},{default:l((()=>[r(V,{class:"test-header"},{default:l((()=>[r(y,{class:"test-title"},{default:l((()=>[d("VIPå®Œæ•´åŠŸèƒ½æµ‹è¯•")])),_:1})])),_:1}),r(V,{class:"test-content"},{default:l((()=>[r(V,{class:"status-section"},{default:l((()=>[r(y,{class:"section-title"},{default:l((()=>[d("å½“å‰VIPçŠ¶æ€")])),_:1}),T.vipStatus?(c(),a(V,{key:0,class:"status-card"},{default:l((()=>[r(V,{class:"status-item"},{default:l((()=>[r(y,{class:"label"},{default:l((()=>[d("ç”¨æˆ·è§’è‰²ï¼š")])),_:1}),r(y,{class:u(["value",2===T.vipStatus.userRole?"vip":"normal"])},{default:l((()=>[d(o(T.vipStatus.userRoleName),1)])),_:1},8,["class"])])),_:1}),r(V,{class:"status-item"},{default:l((()=>[r(y,{class:"label"},{default:l((()=>[d("VIPçŠ¶æ€ï¼š")])),_:1}),r(y,{class:u(["value",T.vipStatus.isVip?"active":"inactive"])},{default:l((()=>[d(o(T.vipStatus.isVip?"å·²å¼€é€š":"æœªå¼€é€š"),1)])),_:1},8,["class"])])),_:1}),T.vipStatus.vipExpireTime?(c(),a(V,{key:0,class:"status-item"},{default:l((()=>[r(y,{class:"label"},{default:l((()=>[d("è¿‡æœŸæ—¶é—´ï¼š")])),_:1}),r(y,{class:"value"},{default:l((()=>[d(o(v.formatDate(T.vipStatus.vipExpireTime)),1)])),_:1})])),_:1})):n("",!0)])),_:1})):n("",!0),r(w,{class:"test-button",onClick:v.checkVipStatus},{default:l((()=>[d("åˆ·æ–°VIPçŠ¶æ€")])),_:1},8,["onClick"])])),_:1}),r(V,{class:"test-section"},{default:l((()=>[r(y,{class:"section-title"},{default:l((()=>[d("åŠŸèƒ½æµ‹è¯•")])),_:1}),r(w,{class:"test-button primary",onClick:v.testCompleteFlow},{default:l((()=>[d("ðŸŽ¯ æµ‹è¯•å®Œæ•´VIPè´­ä¹°æµç¨‹")])),_:1},8,["onClick"]),r(w,{class:"test-button secondary",onClick:v.testVipRecharge},{default:l((()=>[d("ðŸ’Ž æµ‹è¯•VIPå……å€¼é¡µé¢")])),_:1},8,["onClick"]),r(w,{class:"test-button",onClick:v.testCreateOrder},{default:l((()=>[d("ðŸ“ æµ‹è¯•åˆ›å»ºè®¢å•")])),_:1},8,["onClick"]),r(w,{class:"test-button",onClick:v.testPayment},{default:l((()=>[d("ðŸ’³ æµ‹è¯•æ”¯ä»˜æµç¨‹")])),_:1},8,["onClick"])])),_:1}),T.testResults.length>0?(c(),a(V,{key:0,class:"result-section"},{default:l((()=>[r(y,{class:"section-title"},{default:l((()=>[d("æµ‹è¯•ç»“æžœ")])),_:1}),r(V,{class:"result-list"},{default:l((()=>[(c(!0),h(f,null,p(T.testResults,((t,s)=>(c(),a(V,{key:s,class:u(["result-item",t.success?"success":"error"])},{default:l((()=>[r(y,{class:"result-title"},{default:l((()=>[d(o(t.title),1)])),_:2},1024),r(y,{class:"result-message"},{default:l((()=>[d(o(t.message),1)])),_:2},1024),r(y,{class:"result-time"},{default:l((()=>[d(o(t.time),1)])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:1})])),_:1})):n("",!0)])),_:1})])),_:1})}],["__scopeId","data-v-63acd3e3"]]);export{V as default};
