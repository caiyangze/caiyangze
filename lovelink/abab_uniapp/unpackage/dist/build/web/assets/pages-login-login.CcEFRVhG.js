import{_ as e,a,r as l,o as c,g as s,I as o,G as t,d as n,w as i,i as d,f as r,h as u,j as f,k as p,A as h,t as g,s as m,O as v,q as _,u as k,M as w,K as b}from"./index-BpPI9udZ.js";import{_ as x}from"./logo.BZddfDCa.js";import{login as y,loginByCode as M,sendLoginCode as q}from"./api-user-auth.CC_RESsW.js";const C=e({__name:"login",setup(e){const C=a("password"),V=l({phone:"",password:""}),Z=l({phone:"",code:""}),j=l({bg:!1,logo:!1,wechat:!1,qq:!1,weibo:!1}),I=a(!1),z=a(!1),E=a(!1),$=a(60);let F=null;function U(e){C.value=e}function B(e){j[e]=!0}async function A(){if(V.phone)if(V.password)if(/^1[3-9]\d{9}$/.test(V.phone)){I.value=!0;try{const e=await y(V.phone,V.password);e.data&&v("token",e.data),m({title:"登录成功",icon:"success",duration:1500}),setTimeout((()=>{console.log("准备跳转到首页..."),o({url:"/pages/index/index",success:()=>{console.log("跳转首页成功")},fail:e=>{console.error("跳转失败:",e),m({title:"跳转失败，请稍后重试",icon:"none"})}})}),1500)}catch(e){console.error("登录失败:",e)}finally{I.value=!1}}else m({title:"手机号格式不正确",icon:"none"});else m({title:"请输入密码",icon:"none"});else m({title:"请输入手机号",icon:"none"})}async function T(){if(Z.phone)if(Z.code)if(/^1[3-9]\d{9}$/.test(Z.phone)){I.value=!0;try{const e=await M(Z.phone,Z.code);v("token",e.data),console.log("用户信息已保存到本地",e.data),m({title:"登录成功",icon:"success",duration:1500}),setTimeout((()=>{console.log("准备跳转到首页..."),o({url:"/pages/index/index",success:()=>{console.log("跳转首页成功")},fail:e=>{console.error("跳转失败:",e),m({title:"跳转失败，请稍后重试",icon:"none"})}})}),1500)}catch(e){console.error("登录失败:",e)}finally{I.value=!1}}else m({title:"手机号格式不正确",icon:"none"});else m({title:"请输入验证码",icon:"none"});else m({title:"请输入手机号",icon:"none"})}async function D(){if(!E.value&&!z.value)if(Z.phone)if(/^1[3-9]\d{9}$/.test(Z.phone))try{z.value=!0;const e=await q(Z.phone);E.value=!0,$.value=60,F=setInterval((()=>{$.value--,$.value<=0&&(clearInterval(F),E.value=!1)}),1e3),m({title:e.message||"验证码发送成功",icon:"success"})}catch(e){console.error("发送验证码失败:",e)}finally{z.value=!1}else m({title:"手机号格式不正确",icon:"none"});else m({title:"请输入手机号",icon:"none"})}function G(){m({title:"忘记密码功能开发中",icon:"none"})}function H(){o({url:"/pages/register/register",fail:e=>{console.error("跳转到注册页面失败:",e),m({title:"跳转失败，请稍后重试",icon:"none"})}})}function K(e){m({title:`${e}登录功能开发中`,icon:"none"})}function L(e){m({title:("user"===e?"用户协议":"隐私政策")+"查看功能开发中",icon:"none"})}return c((()=>{if(s("token"))return console.log("检测到已登录状态，自动跳转到首页"),void o({url:"/pages/index/index",fail:e=>{console.error("自动跳转失败:",e)}});const e=s("lastLoginPhone");e&&(V.phone=e,Z.phone=e,console.log("自动填充上次登录手机号:",e))})),t((()=>{F&&clearInterval(F)})),(e,a)=>{const l=d,c=_,s=k,o=w,t=b;return r(),n(l,{class:"login-page"},{default:i((()=>[u(l,{class:"bg-layer"},{default:i((()=>[u(l,{class:"bg-gradient"}),u(l,{class:"overlay-gradient"})])),_:1}),u(l,{class:"content-container"},{default:i((()=>[u(l,{class:"header"},{default:i((()=>[u(s,{class:"logo",src:x,mode:"aspectFit",onError:a[0]||(a[0]=e=>B("logo"))},{default:i((()=>[j.logo?(r(),n(l,{key:0,class:"logo-placeholder"},{default:i((()=>[u(c,{class:"logo-text"},{default:i((()=>[f("缘来如此")])),_:1})])),_:1})):p("",!0)])),_:1}),u(l,{class:"slogan"},{default:i((()=>[f("遇见美好，从心开始")])),_:1})])),_:1}),u(l,{class:"login-card"},{default:i((()=>[u(l,{class:"tab-header"},{default:i((()=>[u(l,{class:h(["tab-item",{active:"password"===C.value}]),onClick:a[1]||(a[1]=e=>U("password"))},{default:i((()=>[f(" 密码登录 ")])),_:1},8,["class"]),u(l,{class:h(["tab-item",{active:"code"===C.value}]),onClick:a[2]||(a[2]=e=>U("code"))},{default:i((()=>[f(" 验证码登录 ")])),_:1},8,["class"])])),_:1}),"password"===C.value?(r(),n(l,{key:0,class:"form-container"},{default:i((()=>[u(l,{class:"input-group"},{default:i((()=>[u(l,{class:"input-prefix"},{default:i((()=>[u(c,{class:"prefix-icon phone-icon"},{default:i((()=>[f("+86")])),_:1})])),_:1}),u(o,{class:"input-field",type:"number",modelValue:V.phone,"onUpdate:modelValue":a[3]||(a[3]=e=>V.phone=e),placeholder:"请输入手机号",maxlength:"11"},null,8,["modelValue"])])),_:1}),u(l,{class:"input-group"},{default:i((()=>[u(l,{class:"input-prefix"},{default:i((()=>[u(c,{class:"prefix-icon lock-icon"})])),_:1}),u(o,{class:"input-field",type:"password",modelValue:V.password,"onUpdate:modelValue":a[4]||(a[4]=e=>V.password=e),placeholder:"请输入密码",password:""},null,8,["modelValue"]),u(l,{class:"input-suffix",onClick:G},{default:i((()=>[u(c,{class:"forget-pwd"},{default:i((()=>[f("忘记密码")])),_:1})])),_:1})])),_:1}),u(t,{class:h(["submit-btn",{loading:I.value}]),onClick:A,disabled:I.value},{default:i((()=>[I.value?(r(),n(l,{key:1,class:"btn-loading"})):(r(),n(c,{key:0},{default:i((()=>[f("登录")])),_:1}))])),_:1},8,["class","disabled"])])),_:1})):(r(),n(l,{key:1,class:"form-container"},{default:i((()=>[u(l,{class:"input-group"},{default:i((()=>[u(l,{class:"input-prefix"},{default:i((()=>[u(c,{class:"prefix-icon phone-icon"},{default:i((()=>[f("+86")])),_:1})])),_:1}),u(o,{class:"input-field",type:"number",modelValue:Z.phone,"onUpdate:modelValue":a[5]||(a[5]=e=>Z.phone=e),placeholder:"请输入手机号",maxlength:"11"},null,8,["modelValue"])])),_:1}),u(l,{class:"input-group"},{default:i((()=>[u(l,{class:"input-prefix"},{default:i((()=>[u(c,{class:"prefix-icon code-icon"})])),_:1}),u(o,{class:"input-field",type:"number",modelValue:Z.code,"onUpdate:modelValue":a[6]||(a[6]=e=>Z.code=e),placeholder:"请输入验证码",maxlength:"6"},null,8,["modelValue"]),u(l,{class:"input-suffix"},{default:i((()=>[u(c,{class:h(["code-btn",{disabled:E.value}]),onClick:D},{default:i((()=>[f(g(E.value?`${$.value}s后重新获取`:"获取验证码"),1)])),_:1},8,["class"])])),_:1})])),_:1}),u(t,{class:h(["submit-btn",{loading:I.value}]),onClick:T,disabled:I.value},{default:i((()=>[I.value?(r(),n(l,{key:1,class:"btn-loading"})):(r(),n(c,{key:0},{default:i((()=>[f("登录")])),_:1}))])),_:1},8,["class","disabled"])])),_:1})),u(l,{class:"register-link"},{default:i((()=>[f(" 还没有账号？"),u(c,{class:"link-text",onClick:H},{default:i((()=>[f("立即注册")])),_:1})])),_:1})])),_:1}),u(l,{class:"third-party-login"},{default:i((()=>[u(l,{class:"divider"},{default:i((()=>[u(l,{class:"line"}),u(c,null,{default:i((()=>[f("社交账号登录")])),_:1}),u(l,{class:"line"})])),_:1}),u(l,{class:"social-icons"},{default:i((()=>[u(l,{class:"social-btn wechat",onClick:a[8]||(a[8]=e=>K("wechat"))},{default:i((()=>[u(s,{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='128'%20height='128'%20viewBox='0%200%2024%2024'%3e%3cg%20fill='none'%3e%3cpath%20fill='%2378eb7b'%20d='M12.385%203.757a8.45%208.45%200%200%200-6.93-.541a7.06%207.06%200%200%200-3.633%202.862a5.36%205.36%200%200%200-.669%204.11a6.3%206.3%200%200%200%202.73%203.691q-.372%201.065-.714%202.138c.821-.428%201.634-.872%202.451-1.308a9.1%209.1%200%200%200%203.06.436a5.3%205.3%200%200%201-.211-2.47c.212-1.15.8-2.195%201.673-2.973a7.24%207.24%200%200%201%205.433-1.785a6.34%206.34%200%200%200-3.19-4.162z'/%3e%3cpath%20fill='%23c9f7ca'%20d='M1.176%2010.269c.14-.533.356-1.042.644-1.511a7.05%207.05%200%200%201%203.632-2.863a8.45%208.45%200%200%201%206.93.542c.7.389%201.326.9%201.848%201.507a8%208%200%200%201%201.343-.023a6.34%206.34%200%200%200-3.19-4.162a8.45%208.45%200%200%200-6.931-.541A7.05%207.05%200%200%200%201.82%206.08a5.36%205.36%200%200%200-.67%204.11q.016.038.026.079'/%3e%3cpath%20stroke='%23191919'%20stroke-linecap='round'%20stroke-linejoin='round'%20d='M12.385%203.757a8.45%208.45%200%200%200-6.93-.541a7.06%207.06%200%200%200-3.633%202.862a5.36%205.36%200%200%200-.669%204.11a6.3%206.3%200%200%200%202.73%203.691q-.372%201.065-.714%202.138c.821-.428%201.634-.872%202.451-1.308a9.1%209.1%200%200%200%203.06.436a5.3%205.3%200%200%201-.211-2.47c.212-1.15.8-2.195%201.673-2.973a7.24%207.24%200%200%201%205.433-1.785a6.34%206.34%200%200%200-3.19-4.162z'/%3e%3cpath%20fill='%2378eb7b'%20stroke='%23191919'%20stroke-linecap='round'%20stroke-linejoin='round'%20d='M5.643%206.299a.478.478%200%201%201%20.321.9a.478.478%200%200%201-.321-.9m5.029.005a.478.478%200%201%201%20.338.894a.478.478%200%200%201-.338-.894'/%3e%3cpath%20fill='%2378eb7b'%20d='M22.6%2013.584a5.54%205.54%200%200%200-2.58-2.633a7.11%207.11%200%200%200-6.38.024a5.3%205.3%200%200%200-2.828%203.482a4.48%204.48%200%200%200%20.574%203.314a6.1%206.1%200%200%200%204.157%202.712a7.6%207.6%200%200%200%203.633-.24c.702.274%201.333.716%202.015%201.042a41%2041%200%200%200-.564-1.756a5.7%205.7%200%200%200%201.876-2.073a4.5%204.5%200%200%200%20.112-3.872z'/%3e%3cpath%20fill='%23c9f7ca'%20d='M13.633%2013.288a7.11%207.11%200%200%201%206.38-.024a5.54%205.54%200%200%201%202.58%202.632q.143.325.231.67a4.5%204.5%200%200%200-.23-2.986a5.54%205.54%200%200%200-2.581-2.633a7.11%207.11%200%200%200-6.38.024a5.3%205.3%200%200%200-2.828%203.482c-.151.69-.13%201.406.064%202.085a5.35%205.35%200%200%201%202.764-3.25'/%3e%3cpath%20stroke='%23191919'%20stroke-linecap='round'%20stroke-linejoin='round'%20d='M22.6%2013.584a5.54%205.54%200%200%200-2.58-2.633a7.11%207.11%200%200%200-6.38.024a5.3%205.3%200%200%200-2.828%203.482a4.48%204.48%200%200%200%20.574%203.314a6.1%206.1%200%200%200%204.157%202.712a7.6%207.6%200%200%200%203.633-.24c.702.274%201.333.716%202.015%201.042a41%2041%200%200%200-.564-1.756a5.7%205.7%200%200%200%201.876-2.073a4.5%204.5%200%200%200%20.112-3.872z'/%3e%3cpath%20fill='%2378eb7b'%20d='M14.813%2013.282a.485.485%200%200%201%20.613.617a.478.478%200%201%201-.613-.617'/%3e%3cpath%20stroke='%23191919'%20stroke-linecap='round'%20stroke-linejoin='round'%20d='M14.813%2013.282a.485.485%200%200%201%20.613.617a.478.478%200%201%201-.613-.617'/%3e%3cpath%20fill='%2378eb7b'%20d='M18.968%2013.27c.36-.03.616.342.462.668l-.001.001a.468.468%200%200%201-.74.128a.74.74%200%200%201-.164-.346a.525.525%200%200%201%20.443-.45'/%3e%3cpath%20stroke='%23191919'%20stroke-linecap='round'%20stroke-linejoin='round'%20d='M18.968%2013.27c.36-.03.616.342.462.668l-.001.001a.468.468%200%200%201-.74.128a.74.74%200%200%201-.164-.346a.525.525%200%200%201%20.443-.45'/%3e%3c/g%3e%3c/svg%3e",mode:"aspectFit",onError:a[7]||(a[7]=e=>B("wechat"))},{default:i((()=>[j.wechat?(r(),n(l,{key:0,class:"icon-placeholder wechat-placeholder"})):p("",!0)])),_:1})])),_:1}),u(l,{class:"social-btn qq",onClick:a[10]||(a[10]=e=>K("qq"))},{default:i((()=>[u(s,{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='128'%20height='128'%20viewBox='0%200%2048%2048'%3e%3cmask%20id='IconifyId19830ce80cfd91b535'%3e%3cg%20fill='none'%3e%3cpath%20fill='%23fff'%20d='M23.794%2044.518c-3.659%200-7.017-1.225-9.179-3.053c-1.098.328-2.502.855-3.389%201.51c-.759.56-.664%201.13-.527%201.361c.6%201.013%2010.296.647%2013.095.332v-.15Zm0%200c3.659%200%207.016-1.225%209.179-3.053c1.097.328%202.502.855%203.389%201.51c.758.56.663%201.13.526%201.361c-.6%201.013-10.295.647-13.094.332v-.15Z'/%3e%3cpath%20fill='%23fff'%20d='M23.814%2022.591c6.042-.04%2010.884-1.21%2012.525-1.658c.39-.107.6-.3.6-.3c.001-.055.025-.983.025-1.462c0-8.066-3.808-16.17-13.172-16.171c-9.364%200-13.171%208.105-13.171%2016.171c0%20.48.023%201.407.025%201.462c0%200%20.17.18.481.267c1.515.421%206.448%201.65%2012.643%201.691h.044Zm16.418%206.72c-.375-1.206-.886-2.61-1.404-3.96c0%200-.297-.037-.448.006c-4.645%201.35-10.275%202.21-14.566%202.158h-.044c-4.267.05-9.858-.8-14.488-2.136c-.177-.05-.526-.029-.526-.029c-.518%201.35-1.029%202.756-1.403%203.96c-1.786%205.748-1.208%208.126-.767%208.18c.945.114%203.68-4.327%203.68-4.327c0%204.513%204.073%2011.441%2013.403%2011.505h.247c9.329-.064%2013.403-6.992%2013.403-11.505c0%200%202.734%204.44%203.68%204.327c.44-.054%201.019-2.432-.767-8.18Z'/%3e%3cpath%20fill='%23000'%20d='M20.46%2014.916c-1.27.057-2.355-1.39-2.423-3.23c-.07-1.84.904-3.378%202.174-3.436c1.27-.057%202.354%201.39%202.423%203.23c.07%201.84-.904%203.38-2.174%203.436Zm9.088-3.23c-.068%201.84-1.153%203.287-2.424%203.23c-1.27-.057-2.242-1.595-2.173-3.436c.069-1.84%201.154-3.286%202.423-3.23c1.27.058%202.243%201.596%202.174%203.437Zm2.257%205.828c-.34-.751-3.758-1.59-7.99-1.59h-.046c-4.232%200-7.65.839-7.99%201.59a.253.253%200%200%200-.025.108c0%20.052.017.102.047.145c.286.416%204.082%202.477%207.968%202.477h.046c3.886%200%207.682-2.06%207.968-2.477a.256.256%200%200%200%20.047-.146a.25.25%200%200%200-.025-.106'/%3e%3cpath%20fill='%23fff'%20d='M22.022%2011.714c.058.727-.34%201.373-.89%201.443c-.549.07-1.04-.461-1.1-1.188c-.057-.727.341-1.373.89-1.443c.55-.071%201.042.461%201.1%201.188Zm3.49.243c.112-.201.877-1.259%202.46-.874c.415.102.608.25.648.309c.06.086.077.21.016.375c-.12.329-.369.32-.506.256c-.09-.042-1.192-.777-2.208.32c-.07.075-.195.1-.313.012c-.119-.09-.167-.272-.097-.398Z'/%3e%3cpath%20fill='%23000'%20d='M23.814%2027.25h-.045c-2.918.035-6.455-.351-9.882-1.027c-.293%201.699-.47%203.834-.318%206.38c.384%206.433%204.205%2010.478%2010.104%2010.536h.24c5.898-.058%209.718-4.103%2010.103-10.537c.152-2.546-.025-4.68-.319-6.379c-3.426.676-6.965%201.063-9.883%201.027'/%3e%3cpath%20fill='%23fff'%20d='M15.504%2026.712v6.332s2.9.585%205.807.18v-5.841a53.39%2053.39%200%200%201-5.807-.671Z'/%3e%3cpath%20fill='%23fff'%20d='M36.938%2020.634s-5.642%201.78-13.124%201.831h-.044c-7.47-.05-13.105-1.825-13.124-1.831l-1.89%204.716c4.726%201.425%2010.584%202.343%2015.014%202.29h.044c4.43.053%2010.287-.865%2015.014-2.29l-1.89-4.716Z'/%3e%3c/g%3e%3c/mask%3e%3cpath%20fill='%23333333'%20d='M0%200h48v48H0z'%20mask='url(%23IconifyId19830ce80cfd91b535)'/%3e%3c/svg%3e",mode:"aspectFit",onError:a[9]||(a[9]=e=>B("qq"))},{default:i((()=>[j.qq?(r(),n(l,{key:0,class:"icon-placeholder qq-placeholder"})):p("",!0)])),_:1})])),_:1}),u(l,{class:"social-btn weibo",onClick:a[12]||(a[12]=e=>K("weibo"))},{default:i((()=>[u(s,{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='128'%20height='128'%20viewBox='0%200%201024%201024'%3e%3cpath%20fill='%23eab308'%20d='M457.3%20543c-68.1-17.7-145%2016.2-174.6%2076.2c-30.1%2061.2-1%20129.1%2067.8%20151.3c71.2%2023%20155.2-12.2%20184.4-78.3c28.7-64.6-7.2-131-77.6-149.2m-52%20156.2c-13.8%2022.1-43.5%2031.7-65.8%2021.6c-22-10-28.5-35.7-14.6-57.2c13.7-21.4%2042.3-31%2064.4-21.7c22.4%209.5%2029.6%2035%2016%2057.3m45.5-58.5c-5%208.6-16.1%2012.7-24.7%209.1c-8.5-3.5-11.2-13.1-6.4-21.5c5-8.4%2015.6-12.4%2024.1-9.1c8.7%203.2%2011.8%2012.9%207%2021.5m334.5-197.2c15%204.8%2031-3.4%2035.9-18.3c11.8-36.6%204.4-78.4-23.2-109a111.39%20111.39%200%200%200-106-34.3a28.45%2028.45%200%200%200-21.9%2033.8a28.39%2028.39%200%200%200%2033.8%2021.8c18.4-3.9%2038.3%201.8%2051.9%2016.7a54.2%2054.2%200%200%201%2011.3%2053.3a28.45%2028.45%200%200%200%2018.2%2036m99.8-206c-56.7-62.9-140.4-86.9-217.7-70.5a32.98%2032.98%200%200%200-25.4%2039.3a33.12%2033.12%200%200%200%2039.3%2025.5c55-11.7%20114.4%205.4%20154.8%2050.1c40.3%2044.7%2051.2%20105.7%2034%20159.1c-5.6%2017.4%203.9%2036%2021.3%2041.7c17.4%205.6%2036-3.9%2041.6-21.2v-.1c24.1-75.4%208.9-161.1-47.9-223.9M729%20499c-12.2-3.6-20.5-6.1-14.1-22.1c13.8-34.7%2015.2-64.7.3-86c-28-40.1-104.8-37.9-192.8-1.1c0%200-27.6%2012.1-20.6-9.8c13.5-43.5%2011.5-79.9-9.6-101c-47.7-47.8-174.6%201.8-283.5%20110.6C127.3%20471.1%2080%20557.5%2080%20632.2C80%20775.1%20263.2%20862%20442.5%20862c235%200%20391.3-136.5%20391.3-245c0-65.5-55.2-102.6-104.8-118M443%20810.8c-143%2014.1-266.5-50.5-275.8-144.5c-9.3-93.9%2099.2-181.5%20242.2-195.6c143-14.2%20266.5%2050.5%20275.8%20144.4C694.4%20709%20586%20796.6%20443%20810.8'/%3e%3c/svg%3e",mode:"aspectFit",onError:a[11]||(a[11]=e=>B("weibo"))},{default:i((()=>[j.weibo?(r(),n(l,{key:0,class:"icon-placeholder weibo-placeholder"})):p("",!0)])),_:1})])),_:1})])),_:1})])),_:1}),u(l,{class:"agreement"},{default:i((()=>[u(c,{class:"agreement-text"},{default:i((()=>[f("登录即表示您已同意")])),_:1}),u(c,{class:"agreement-link",onClick:a[13]||(a[13]=e=>L("user"))},{default:i((()=>[f("《用户协议》")])),_:1}),u(c,{class:"agreement-text"},{default:i((()=>[f("和")])),_:1}),u(c,{class:"agreement-link",onClick:a[14]||(a[14]=e=>L("privacy"))},{default:i((()=>[f("《隐私政策》")])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-90151c21"]]);export{C as default};
