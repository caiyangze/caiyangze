# AI红娘功能使用说明

## 🎯 功能概述

AI红娘是一个智能婚恋助手，集成了多种AI功能，为用户提供专业的婚恋服务。

## ✨ 主要功能

### 1. 智能对话
- 🤖 基于大语言模型的智能对话
- 💬 流式回复，实时响应
- 🧠 记忆功能，上下文理解

### 2. 智能推荐
- 💑 **异性用户推荐**：根据用户信息智能匹配合适的异性用户
- 🌹 **专业红娘推荐**：推荐专业红娘提供一对一服务
- 📊 多维度匹配算法，提高匹配成功率

### 3. 多模态交互
- 🎨 **文生图功能**：根据描述生成个性化图片
- 🗣️ **语音聊天**：支持语音输入和语音回复（开发中）
- 📷 **图片理解**：分析用户上传的图片（开发中）

## 🚀 使用方法

### 启动后端服务
```bash
cd langchain4j-ai
mvn spring-boot:run
```
后端服务将在 `http://localhost:8084` 启动

### 启动前端应用
```bash
cd abab_uniapp
npm run dev:h5
```

### 访问AI红娘
1. 打开应用，进入"消息"页面
2. 点击顶部的"AI红娘小智"卡片
3. 开始与AI红娘对话

### 功能测试
访问测试页面：`/pages/test/ai-test`
- 测试后端连接
- 测试AI聊天功能
- 快速功能测试

## 💡 使用技巧

### 推荐用户
- 直接说："请为我推荐一些合适的异性用户"
- 或点击功能按钮中的"💑 推荐用户"

### 推荐红娘
- 直接说："请为我推荐一些专业的红娘"
- 或点击功能按钮中的"🌹 推荐红娘"

### 生成图片
- 直接说："请为我生成一张图片：浪漫约会场景"
- 或点击功能按钮中的"🎨 生成图片"

## 🔧 技术架构

### 后端技术
- **框架**：Spring Boot 3.x
- **AI引擎**：LangChain4j
- **大模型**：阿里云通义千问
- **数据库**：MySQL + MongoDB

### 前端技术
- **框架**：uni-app (Vue 3)
- **UI**：自定义组件
- **网络**：流式HTTP请求

## 📱 界面说明

### 消息页面
- 顶部显示AI红娘入口卡片
- 点击即可进入AI聊天页面

### AI聊天页面
- 顶部：AI红娘信息和菜单
- 中间：聊天消息区域
- 底部：输入框和功能按钮

### 功能按钮
- **+/-**：展开/收起功能按钮
- **💑**：推荐异性用户
- **🌹**：推荐专业红娘
- **🎨**：生成个性化图片

## ⚠️ 注意事项

1. **网络连接**：确保前后端网络连通
2. **端口配置**：后端默认端口8084
3. **API密钥**：需要配置通义千问API密钥
4. **数据库**：需要MySQL和MongoDB支持

## 🐛 常见问题

### 页面不存在错误
- 确认pages.json中已添加路由配置
- 检查页面文件是否存在
- 重新编译前端项目

### 连接失败
- 检查后端服务是否启动（端口8084）
- 确认跨域配置是否正确
- 检查防火墙设置
- 验证网络连接

### 编译错误
- **跨域配置错误**：已修复类型转换问题
- **依赖冲突**：确保Spring Boot版本兼容
- **API密钥**：检查通义千问API密钥配置

### AI回复异常
- 检查API密钥配置
- 查看后端日志
- 确认网络连接正常
- 验证模型名称是否正确

### 数据库连接问题
- 检查MySQL连接配置
- 验证MongoDB服务状态
- 确认数据库权限设置

## ✅ 配置验证

### 启动验证
后端启动时会自动验证关键配置：
- ✓ 服务端口配置
- ✓ 跨域配置状态
- ✓ AI模型API密钥
- ✓ 数据库连接配置
- ✓ MongoDB配置状态

### 手动验证步骤
1. **后端服务**：访问 `http://localhost:8084/xiaozhi/chat`
2. **跨域配置**：前端能正常发送请求
3. **AI功能**：使用测试页面验证聊天功能
4. **数据库**：检查用户和红娘数据

## 🔧 故障排除

### 跨域问题已修复
- 修复了 `CorsConfiguration` 类型转换错误
- 提供双重跨域保障（全局配置 + 控制器注解）
- 支持所有必要的HTTP方法和请求头

### 性能优化建议
- 启用HTTP/2支持
- 配置连接池参数
- 设置合适的超时时间
- 监控内存使用情况

## 📞 技术支持

如有问题，请按以下顺序检查：
1. **启动日志**：查看控制台输出的验证信息
2. **后端服务**：确认8084端口服务正常
3. **前端控制台**：检查浏览器开发者工具错误
4. **网络连接**：验证前后端通信正常
5. **配置文件**：检查API密钥和数据库配置
