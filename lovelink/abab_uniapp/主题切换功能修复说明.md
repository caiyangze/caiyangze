# ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½ä¿®å¤è¯´æ˜ï¼ˆæœ€ç»ˆç‰ˆæœ¬ï¼‰

## é—®é¢˜åˆ†æ

æ‚¨çš„é¡¹ç›®ä¸­å­˜åœ¨ä¸»é¢˜åˆ‡æ¢åªèƒ½åœ¨ä¸»é¡µï¼ˆæˆ‘çš„é¡µé¢ï¼‰ç”Ÿæ•ˆçš„é—®é¢˜ï¼Œç»è¿‡ä»”ç»†åˆ†ææ‚¨çš„é¡µé¢å®ç°ï¼Œå‘ç°ä¸»è¦åŸå› å¦‚ä¸‹ï¼š

### 1. åŒä¸»é¢˜ç³»ç»Ÿå†²çª
- **å¤æ‚ä¸»é¢˜ç³»ç»Ÿ** (`utils/theme.js`) - åŠŸèƒ½å®Œæ•´ä½†ä½¿ç”¨å¤æ‚
- **ç®€åŒ–ä¸»é¢˜ç³»ç»Ÿ** (`utils/simple-theme.js`) - ç®€å•ä½†åŠŸèƒ½æœ‰é™
- ä¸åŒé¡µé¢ä½¿ç”¨ä¸åŒçš„ä¸»é¢˜ç³»ç»Ÿï¼Œå¯¼è‡´ä¸»é¢˜åˆ‡æ¢ä¸åŒæ­¥

### 2. äº‹ä»¶ä¼ æ’­ä¸ä¸€è‡´
- ä¸¤å¥—ç³»ç»Ÿçš„äº‹ä»¶æœºåˆ¶ä¸ç»Ÿä¸€
- æŸäº›é¡µé¢æ²¡æœ‰æ­£ç¡®ç›‘å¬ä¸»é¢˜å˜åŒ–äº‹ä»¶

### 3. å“åº”å¼æ›´æ–°é—®é¢˜
- éƒ¨åˆ†é¡µé¢çš„ä¸»é¢˜æ•°æ®æ²¡æœ‰æ­£ç¡®ç»‘å®šåˆ°å“åº”å¼å˜é‡

## è§£å†³æ–¹æ¡ˆ

### 1. åˆ†ææ‚¨çš„é¡µé¢æˆåŠŸæ¨¡å¼
é€šè¿‡ä»”ç»†åˆ†ææ‚¨çš„é¡µé¢ï¼ˆmineé¡µé¢ï¼‰çš„æˆåŠŸå®ç°ï¼Œå‘ç°å…³é”®æ¨¡å¼ï¼š

```javascript
// 1. æ­£ç¡®çš„å¯¼å…¥
import { currentBackground } from '@/utils/simple-theme.js'
import { useTheme } from '@/mixins/theme-mixin.js'

// 2. æ­£ç¡®çš„è®¡ç®—å±æ€§
const computedBg = computed(() => {
  return computedBackground.value || currentBackground.value;
});

// 3. æ­£ç¡®çš„æ··å…¥ä½¿ç”¨
const { currentTheme, computedBackground, changeTheme, availableThemes } = useTheme();

// 4. æ¨¡æ¿ä¸­æ­£ç¡®ç»‘å®š
:style="{ background: computedBg }"
```

### 2. æŒ‰ç…§æ‚¨çš„æ¨¡å¼ä¿®å¤æ‰€æœ‰é¡µé¢
- **é¦–é¡µ** (`pages/index/index.vue`) - å®Œå…¨å¤åˆ¶æ‚¨çš„æ¨¡å¼
- **å¹¿åœº** (`pages/square/square.vue`) - å®Œå…¨å¤åˆ¶æ‚¨çš„æ¨¡å¼
- **æ¶ˆæ¯** (`pages/message/message.vue`) - å®Œå…¨å¤åˆ¶æ‚¨çš„æ¨¡å¼
- **æµ‹è¯•é¡µé¢** (`pages/test/unified-theme-test.vue`) - å®Œå…¨å¤åˆ¶æ‚¨çš„æ¨¡å¼

### 3. ä¿®å¤æ ¸å¿ƒé—®é¢˜
- æ·»åŠ ç¼ºå¤±çš„ `changeTheme` å¯¼å‡ºåˆ° `simple-theme.js`
- ç¡®ä¿ `useTheme()` æ··å…¥è¿”å›æ­£ç¡®çš„å“åº”å¼æ•°æ®
- æ‰€æœ‰é¡µé¢ä½¿ç”¨ç›¸åŒçš„è®¡ç®—å±æ€§æ¨¡å¼

### 4. æ·»åŠ ä¾¿æ·çš„ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œåœ¨æ¯ä¸ªé¡µé¢éƒ½æ·»åŠ äº†å¿«é€Ÿä¸»é¢˜åˆ‡æ¢æŒ‰é’®ï¼š
- **é¦–é¡µ** - å³ä¸Šè§’è´§å¸æ—è¾¹çš„ğŸ¨æŒ‰é’®
- **å¹¿åœº** - å³ä¸Šè§’è´§å¸æ—è¾¹çš„ğŸ¨æŒ‰é’®
- **æ¶ˆæ¯** - å³ä¸Šè§’æœç´¢æ—è¾¹çš„ğŸ¨æŒ‰é’®
- **æˆ‘çš„** - åŸæœ‰çš„ä¸»é¢˜é€‰æ‹©å™¨

### 5. ä¿æŒæ‚¨çš„é¡µé¢å®Œæ•´åŠŸèƒ½
- ä¿ç•™æ‚¨é¡µé¢çš„æ‰€æœ‰åŸæœ‰åŠŸèƒ½
- ä¿æŒæ‚¨é¡µé¢çš„ä¸»é¢˜é€‰æ‹©å™¨ä¸å˜
- å…¶ä»–é¡µé¢é‡‡ç”¨ç›¸åŒçš„åº•å±‚å®ç°

## ä¿®å¤çš„æ–‡ä»¶åˆ—è¡¨

### æ ¸å¿ƒæ–‡ä»¶
1. `utils/simple-theme.js` - æ·»åŠ ç¼ºå¤±çš„ `changeTheme` å¯¼å‡º
2. `mixins/theme-mixin.js` - ç¡®ä¿è¿”å›æ­£ç¡®çš„å“åº”å¼æ•°æ®

### é¡µé¢æ–‡ä»¶ï¼ˆå®Œå…¨æŒ‰ç…§æ‚¨çš„æ¨¡å¼ä¿®å¤ï¼‰
1. `pages/index/index.vue` - å¤åˆ¶æ‚¨çš„æˆåŠŸæ¨¡å¼ + æ·»åŠ å¿«é€Ÿåˆ‡æ¢æŒ‰é’®
2. `pages/square/square.vue` - å¤åˆ¶æ‚¨çš„æˆåŠŸæ¨¡å¼ + æ·»åŠ å¿«é€Ÿåˆ‡æ¢æŒ‰é’®
3. `pages/message/message.vue` - å¤åˆ¶æ‚¨çš„æˆåŠŸæ¨¡å¼ + æ·»åŠ å¿«é€Ÿåˆ‡æ¢æŒ‰é’®
4. `pages/test/unified-theme-test.vue` - å¤åˆ¶æ‚¨çš„æˆåŠŸæ¨¡å¼
5. `pages/mine/mine.vue` - ä¿æŒåŸæœ‰åŠŸèƒ½ä¸å˜

## ä½¿ç”¨æ–¹æ³•ï¼ˆå®Œå…¨æŒ‰ç…§æ‚¨çš„æˆåŠŸæ¨¡å¼ï¼‰

### 1. åœ¨é¡µé¢ä¸­ä½¿ç”¨ä¸»é¢˜ï¼ˆæ‚¨çš„æˆåŠŸæ¨¡å¼ï¼‰
```javascript
import { reactive, ref, onMounted, computed } from 'vue'
import { useTheme } from '@/mixins/theme-mixin.js'
import { currentBackground } from '@/utils/simple-theme.js'

// è®¡ç®—å±æ€§ç¡®ä¿å“åº”å¼æ›´æ–°ï¼ˆå®Œå…¨å‚è€ƒæ‚¨çš„é¡µé¢ï¼‰
const computedBg = computed(() => {
  // ä½¿ç”¨ç»Ÿä¸€ä¸»é¢˜æ··å…¥çš„èƒŒæ™¯
  return computedBackground.value || currentBackground.value;
});

// ä½¿ç”¨ç»Ÿä¸€ä¸»é¢˜æ··å…¥ï¼ˆå®Œå…¨å‚è€ƒæ‚¨çš„é¡µé¢ï¼‰
const { currentTheme, getThemeStyles, computedBackground, changeTheme, availableThemes } = useTheme();
```

### 2. åœ¨æ¨¡æ¿ä¸­ç»‘å®šèƒŒæ™¯ï¼ˆæ‚¨çš„æˆåŠŸæ¨¡å¼ï¼‰
```vue
<template>
  <view class="page" :style="{ background: computedBg }">
    <!-- èƒŒæ™¯å±‚ -->
    <view class="bg-layer" :style="{ background: computedBg }">
      <view class="bg-gradient"></view>
      <view class="overlay-gradient"></view>
    </view>
    <!-- é¡µé¢å†…å®¹ -->
  </view>
</template>
```

### 3. ä¸»é¢˜åˆ‡æ¢æ–¹æ³•ï¼ˆæ‚¨çš„æˆåŠŸæ¨¡å¼ï¼‰
```javascript
function selectTheme(themeId) {
  const success = changeTheme(themeId);
  if (success) {
    uni.showToast({
      title: `å·²åˆ‡æ¢åˆ°${themeName}`,
      icon: 'success'
    });
  }
}
```

## æµ‹è¯•æ–¹æ³•

### æ–¹æ³•1ï¼šä½¿ç”¨æ‚¨çš„é¡µé¢æµ‹è¯•ï¼ˆæ¨èï¼‰
1. è¿›å…¥ "æˆ‘çš„" é¡µé¢
2. ç‚¹å‡» "ä¸»é¢˜åˆ‡æ¢" é€‰æ‹©ä¸åŒä¸»é¢˜
3. å¯¼èˆªåˆ°é¦–é¡µã€å¹¿åœºã€æ¶ˆæ¯é¡µé¢éªŒè¯ä¸»é¢˜åŒæ­¥

### æ–¹æ³•2ï¼šä½¿ç”¨å¿«é€Ÿåˆ‡æ¢æŒ‰é’®æµ‹è¯•
1. åœ¨é¦–é¡µç‚¹å‡»å³ä¸Šè§’ğŸ¨æŒ‰é’®ï¼ˆè´§å¸æ—è¾¹ï¼‰
2. åœ¨å¹¿åœºé¡µç‚¹å‡»å³ä¸Šè§’ğŸ¨æŒ‰é’®ï¼ˆè´§å¸æ—è¾¹ï¼‰
3. åœ¨æ¶ˆæ¯é¡µç‚¹å‡»å³ä¸Šè§’ğŸ¨æŒ‰é’®ï¼ˆæœç´¢æ—è¾¹ï¼‰
4. è§‚å¯Ÿä¸»é¢˜æ˜¯å¦åœ¨æ‰€æœ‰é¡µé¢åŒæ­¥åˆ‡æ¢

### æ–¹æ³•3ï¼šä½¿ç”¨ç®€å•æµ‹è¯•é¡µé¢
1. è®¿é—® "æˆ‘çš„" é¡µé¢ï¼Œç‚¹å‡» "ç®€å•ä¸»é¢˜æµ‹è¯•"
2. åœ¨æµ‹è¯•é¡µé¢åˆ‡æ¢ä¸»é¢˜
3. ä½¿ç”¨é¡µé¢å¯¼èˆªæŒ‰é’®éªŒè¯å…¶ä»–é¡µé¢

## æœ€ç»ˆä¿®å¤ç­–ç•¥

### å‘ç°å…³é”®é—®é¢˜ï¼šåº•éƒ¨å¯¼èˆªæ çš„æˆåŠŸæ¨¡å¼
ç»è¿‡æ·±å…¥åˆ†æï¼Œæˆ‘å‘ç°äº†å…³é”®é—®é¢˜ï¼åº•éƒ¨å¯¼èˆªæ èƒ½å¤Ÿæ­£å¸¸å“åº”ä¸»é¢˜å˜åŒ–çš„åŸå› æ˜¯ä½¿ç”¨äº† `watch` ç›‘å¬ï¼š

```javascript
// åº•éƒ¨å¯¼èˆªæ çš„æˆåŠŸä»£ç 
watch(currentBackground, (newBg) => {
  console.log('åº•éƒ¨å¯¼èˆªæ ä¸»é¢˜å˜åŒ–:', newBg);
  tabBarBg.value = newBg;
}, { immediate: true });
```

### é‡‡ç”¨åº•éƒ¨å¯¼èˆªæ çš„æˆåŠŸæ¨¡å¼
æˆ‘å°†åº•éƒ¨å¯¼èˆªæ çš„æˆåŠŸæ¨¡å¼åº”ç”¨åˆ°æ‰€æœ‰é¡µé¢ï¼š

1. **ç®€åŒ–çš„ä¸»é¢˜å˜é‡**ï¼š
   ```javascript
   // ä¸»é¢˜ç›¸å…³ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼Œç›´æ¥å¤åˆ¶åº•éƒ¨å¯¼èˆªæ çš„æˆåŠŸæ¨¡å¼ï¼‰
   const pageBg = ref('linear-gradient(135deg, #667eea 0%, #764ba2 100%)');
   ```

2. **å…³é”®çš„watchç›‘å¬**ï¼š
   ```javascript
   // ç›‘å¬ä¸»é¢˜å˜åŒ–ï¼ˆå…³é”®ï¼å®Œå…¨å¤åˆ¶åº•éƒ¨å¯¼èˆªæ çš„æˆåŠŸæ¨¡å¼ï¼‰
   watch(currentBackground, (newBg) => {
     console.log('é¡µé¢ä¸»é¢˜å˜åŒ–:', newBg);
     pageBg.value = newBg;
   }, { immediate: true });
   ```

3. **ç®€åŒ–çš„è®¡ç®—å±æ€§**ï¼š
   ```javascript
   // è®¡ç®—å±æ€§ç¡®ä¿å“åº”å¼æ›´æ–°ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰
   const computedBg = computed(() => {
     return pageBg.value;
   });
   ```

4. **ç®€åŒ–çš„åˆå§‹åŒ–**ï¼š
   ```javascript
   onMounted(() => {
     // åˆå§‹åŒ–ä¸»é¢˜ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰
     initSimpleTheme();
   });
   ```

5. **ç®€åŒ–çš„åˆ‡æ¢é€»è¾‘**ï¼š
   ```javascript
   function quickSwitchTheme() {
     // ä½¿ç”¨switchThemeå‡½æ•°ï¼Œå®ƒä¼šè‡ªåŠ¨æ›´æ–°currentBackground
     const success = switchTheme(nextTheme.id);
   }
   ```

ç°åœ¨æ‰€æœ‰é¡µé¢éƒ½ä½¿ç”¨ä¸æ‚¨çš„é¡µé¢å®Œå…¨ç›¸åŒçš„å®ç°æ¨¡å¼ï¼Œåº”è¯¥èƒ½å¤Ÿæ­£å¸¸åŒæ­¥ä¸»é¢˜åˆ‡æ¢äº†ï¼
