# 《聊巴》项目数据库设计方案

根据您提供的《聊巴》项目需求文档，我为您设计了一套完整的数据库方案。这个设计充分考虑了项目的核心功能模块，包括用户管理、社交互动、红娘服务、娱乐游戏等各个方面。

## 一、数据库概览

数据库采用关系型数据库（如MySQL）作为主要存储，同时考虑Redis缓存来提升高频访问数据的性能。

### 主要数据表分组：

1. 用户相关表组：存储用户基础信息、认证信息、隐私设置等

1. 社交互动表组：记录用户间的关注、留言、点赞等互动行为

1. 红娘服务表组：管理红娘信息、匹配记录、约会安排等

1. 娱乐互动表组：包含游戏记录、语音房、线上派对等功能数据

1. 内容管理表组：存储动态、话题、社群等用户生成内容

1. 交易与支付表组：记录会员购买、虚拟消费、红娘分成等财务数据

1. 系统配置表组：存储系统参数、权限设置等管理数据

## 二、数据库表设计

### 1. 用户相关表组

#### 1.1 用户基础信息表（tb_user）

CREATE TABLE `tb_user` (

 `user_id` bigint NOT NULL AUTO_INCREMENT COMMENT '用户ID',

 `phone` varchar(20) DEFAULT NULL COMMENT '手机号',

 `password` varchar(128) DEFAULT NULL COMMENT '密码（加密存储）',

 `nickname` varchar(50) NOT NULL COMMENT '昵称',

 `gender` tinyint NOT NULL COMMENT '性别：0-未知，1-男，2-女',

 `birth_date` date DEFAULT NULL COMMENT '出生日期',

 `avatar_url` varchar(255) DEFAULT NULL COMMENT '头像URL',

 `user_role` tinyint NOT NULL DEFAULT '1' COMMENT '用户角色：1-普通用户，2-VIP用户，3-预备红娘，4-正式红娘',

 `register_source` tinyint DEFAULT '1' COMMENT '注册来源：1-手机号，2-微信，3-QQ',

 `open_id` varchar(64) DEFAULT NULL COMMENT '第三方平台ID',

 `register_time` datetime NOT NULL COMMENT '注册时间',

 `last_login_time` datetime DEFAULT NULL COMMENT '最后登录时间',

 `last_login_ip` varchar(64) DEFAULT NULL COMMENT '最后登录IP',

 `account_status` tinyint NOT NULL DEFAULT '1' COMMENT '账号状态：0-冻结，1-正常，2-注销',

 `is_verified` tinyint NOT NULL DEFAULT '0' COMMENT '是否实名认证：0-否，1-是',

 `is_vip` tinyint NOT NULL DEFAULT '0' COMMENT '是否VIP：0-否，1-是',

 `vip_expire_time` datetime DEFAULT NULL COMMENT 'VIP过期时间',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`user_id`),

 UNIQUE KEY `idx_phone` (`phone`),

 KEY `idx_open_id` (`open_id`),

 KEY `idx_register_time` (`register_time`),

 KEY `idx_user_role` (`user_role`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户基础信息表';

#### 1.2 用户详细资料表（tb_user_profile）

CREATE TABLE `tb_user_profile` (

 `profile_id` bigint NOT NULL AUTO_INCREMENT COMMENT '资料ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `real_name` varchar(50) DEFAULT NULL COMMENT '真实姓名',

 `id_card_no` varchar(128) DEFAULT NULL COMMENT '身份证号（加密存储）',

 `height` int DEFAULT NULL COMMENT '身高(cm)',

 `weight` int DEFAULT NULL COMMENT '体重(kg)',

 `education` tinyint DEFAULT NULL COMMENT '学历：1-高中及以下，2-大专，3-本科，4-硕士，5-博士',

 `education_cert` varchar(255) DEFAULT NULL COMMENT '学历认证图片URL',

 `company` varchar(100) DEFAULT NULL COMMENT '公司',

 `position` varchar(50) DEFAULT NULL COMMENT '职位',

 `income_level` tinyint DEFAULT NULL COMMENT '收入水平：1-5k以下，2-5k-10k，3-10k-20k，4-20k-50k，5-50k以上',

 `work_city` varchar(50) DEFAULT NULL COMMENT '工作城市',

 `hometown` varchar(50) DEFAULT NULL COMMENT '家乡',

 `marital_status` tinyint DEFAULT NULL COMMENT '婚姻状况：1-未婚，2-离异，3-丧偶',

 `has_children` tinyint DEFAULT '0' COMMENT '是否有子女：0-无，1-有',

 `house_status` tinyint DEFAULT NULL COMMENT '住房情况：1-租房，2-有房贷款，3-有房无贷款，4-和家人同住',

 `car_status` tinyint DEFAULT NULL COMMENT '车辆情况：1-无车，2-有车有贷款，3-有车无贷款',

 `self_introduction` text COMMENT '自我介绍',

 `hobby` varchar(500) DEFAULT NULL COMMENT '兴趣爱好',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`profile_id`),

 UNIQUE KEY `idx_user_id` (`user_id`),

 KEY `idx_education` (`education`),

 KEY `idx_work_city` (`work_city`),

 KEY `idx_income_level` (`income_level`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户详细资料表';

#### 1.3 用户择偶标准表（tb_mate_preference）

CREATE TABLE `tb_mate_preference` (

 `preference_id` bigint NOT NULL AUTO_INCREMENT COMMENT '偏好ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `age_min` int DEFAULT NULL COMMENT '最小年龄',

 `age_max` int DEFAULT NULL COMMENT '最大年龄',

 `height_min` int DEFAULT NULL COMMENT '最小身高(cm)',

 `height_max` int DEFAULT NULL COMMENT '最大身高(cm)',

 `education_min` tinyint DEFAULT NULL COMMENT '最低学历',

 `income_min` tinyint DEFAULT NULL COMMENT '最低收入水平',

 `marital_status` varchar(20) DEFAULT NULL COMMENT '可接受的婚姻状况，多选逗号分隔',

 `work_city` varchar(500) DEFAULT NULL COMMENT '期望工作城市，多选逗号分隔',

 `has_house` tinyint DEFAULT NULL COMMENT '是否要求有房：0-不要求，1-要求',

 `has_car` tinyint DEFAULT NULL COMMENT '是否要求有车：0-不要求，1-要求',

 `other_requirements` varchar(500) DEFAULT NULL COMMENT '其他要求',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`preference_id`),

 UNIQUE KEY `idx_user_id` (`user_id`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户择偶标准表';

#### 1.4 用户相册表（tb_user_photo）

CREATE TABLE `tb_user_photo` (

 `photo_id` bigint NOT NULL AUTO_INCREMENT COMMENT '相片ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `photo_url` varchar(255) NOT NULL COMMENT '照片URL',

 `photo_desc` varchar(200) DEFAULT NULL COMMENT '照片描述',

 `is_avatar` tinyint NOT NULL DEFAULT '0' COMMENT '是否头像：0-否，1-是',

 `is_public` tinyint NOT NULL DEFAULT '1' COMMENT '是否公开：0-私密，1-公开',

 `sort_order` int NOT NULL DEFAULT '0' COMMENT '排序顺序',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`photo_id`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_is_avatar` (`is_avatar`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户相册表';

#### 1.5 用户标签表（tb_user_tag）

CREATE TABLE `tb_user_tag` (

 `id` bigint NOT NULL AUTO_INCREMENT COMMENT '主键ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `tag_id` bigint NOT NULL COMMENT '标签ID',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 PRIMARY KEY (`id`),

 UNIQUE KEY `idx_user_tag` (`user_id`,`tag_id`),

 KEY `idx_tag_id` (`tag_id`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户标签关联表';

#### 1.6 标签库表（tb_tag）

CREATE TABLE `tb_tag` (

 `tag_id` bigint NOT NULL AUTO_INCREMENT COMMENT '标签ID',

 `tag_name` varchar(50) NOT NULL COMMENT '标签名称',

 `tag_type` tinyint NOT NULL COMMENT '标签类型：1-兴趣爱好，2-性格特点，3-生活方式，4-其他',

 `tag_status` tinyint NOT NULL DEFAULT '1' COMMENT '标签状态：0-禁用，1-启用',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`tag_id`),

 UNIQUE KEY `idx_tag_name` (`tag_name`),

 KEY `idx_tag_type` (`tag_type`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='标签库表';

#### 1.7 用户隐私设置表（tb_privacy_setting）

CREATE TABLE `tb_privacy_setting` (

 `setting_id` bigint NOT NULL AUTO_INCREMENT COMMENT '设置ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `show_online_status` tinyint NOT NULL DEFAULT '1' COMMENT '显示在线状态：0-不显示，1-显示',

 `show_last_login_time` tinyint NOT NULL DEFAULT '1' COMMENT '显示最后登录时间：0-不显示，1-显示',

 `show_visitor` tinyint NOT NULL DEFAULT '1' COMMENT '显示访客记录：0-不显示，1-显示',

 `allow_stranger_message` tinyint NOT NULL DEFAULT '1' COMMENT '允许陌生人留言：0-不允许，1-允许',

 `profile_visible_level` tinyint NOT NULL DEFAULT '1' COMMENT '资料可见级别：1-所有人，2-已关注的人，3-VIP用户',

 `photo_visible_level` tinyint NOT NULL DEFAULT '1' COMMENT '相册可见级别：1-所有人，2-已关注的人，3-VIP用户',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`setting_id`),

 UNIQUE KEY `idx_user_id` (`user_id`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户隐私设置表';

#### 1.8 实名认证表（tb_user_verification）

CREATE TABLE `tb_user_verification` (

 `verification_id` bigint NOT NULL AUTO_INCREMENT COMMENT '认证ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `real_name` varchar(50) NOT NULL COMMENT '真实姓名',

 `id_card_no` varchar(128) NOT NULL COMMENT '身份证号（加密存储）',

 `id_card_front` varchar(255) NOT NULL COMMENT '身份证正面照片URL',

 `id_card_back` varchar(255) NOT NULL COMMENT '身份证背面照片URL',

 `face_photo` varchar(255) DEFAULT NULL COMMENT '人脸照片URL',

 `verification_status` tinyint NOT NULL DEFAULT '0' COMMENT '认证状态：0-待审核，1-已通过，2-已拒绝',

 `reject_reason` varchar(200) DEFAULT NULL COMMENT '拒绝原因',

 `verified_time` datetime DEFAULT NULL COMMENT '认证通过时间',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`verification_id`),

 UNIQUE KEY `idx_user_id` (`user_id`),

 KEY `idx_verification_status` (`verification_status`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='实名认证表';

### 2. 社交互动表组

#### 2.1 用户关注表（tb_follow）

CREATE TABLE `tb_follow` (

 `follow_id` bigint NOT NULL AUTO_INCREMENT COMMENT '关注ID',

 `user_id` bigint NOT NULL COMMENT '关注人ID',

 `followed_user_id` bigint NOT NULL COMMENT '被关注人ID',

 `follow_status` tinyint NOT NULL DEFAULT '1' COMMENT '关注状态：0-取消关注，1-已关注',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`follow_id`),

 UNIQUE KEY `idx_user_followed` (`user_id`,`followed_user_id`),

 KEY `idx_followed_user_id` (`followed_user_id`),

 KEY `idx_follow_status` (`follow_status`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户关注表';

#### 2.2 用户留言表（tb_message）

CREATE TABLE `tb_message` (

 `message_id` bigint NOT NULL AUTO_INCREMENT COMMENT '留言ID',

 `sender_id` bigint NOT NULL COMMENT '发送者ID',

 `receiver_id` bigint NOT NULL COMMENT '接收者ID',

 `message_content` varchar(500) NOT NULL COMMENT '留言内容',

 `is_read` tinyint NOT NULL DEFAULT '0' COMMENT '是否已读：0-未读，1-已读',

 `is_top` tinyint NOT NULL DEFAULT '0' COMMENT '是否置顶：0-否，1-是',

 `is_deleted` tinyint NOT NULL DEFAULT '0' COMMENT '是否删除：0-否，1-是',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`message_id`),

 KEY `idx_sender_id` (`sender_id`),

 KEY `idx_receiver_id` (`receiver_id`),

 KEY `idx_is_read` (`is_read`),

 KEY `idx_is_top` (`is_top`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户留言表';

#### 2.3 访客记录表（tb_visitor）

CREATE TABLE `tb_visitor` (

 `visit_id` bigint NOT NULL AUTO_INCREMENT COMMENT '访问ID',

 `visitor_id` bigint NOT NULL COMMENT '访客ID',

 `visited_user_id` bigint NOT NULL COMMENT '被访问用户ID',

 `visit_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '访问时间',

 `is_read` tinyint NOT NULL DEFAULT '0' COMMENT '是否已读：0-未读，1-已读',

 PRIMARY KEY (`visit_id`),

 KEY `idx_visitor_id` (`visitor_id`),

 KEY `idx_visited_user_id` (`visited_user_id`),

 KEY `idx_visit_time` (`visit_time`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='访客记录表';

#### 2.4 点赞表（tb_like）

CREATE TABLE `tb_like` (

 `like_id` bigint NOT NULL AUTO_INCREMENT COMMENT '点赞ID',

 `user_id` bigint NOT NULL COMMENT '点赞用户ID',

 `target_id` bigint NOT NULL COMMENT '点赞目标ID',

 `target_type` tinyint NOT NULL COMMENT '点赞类型：1-动态，2-照片，3-评论',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 PRIMARY KEY (`like_id`),

 UNIQUE KEY `idx_user_target` (`user_id`,`target_id`,`target_type`),

 KEY `idx_target_id` (`target_id`,`target_type`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='点赞表';

#### 2.5 礼物表（tb_gift）

CREATE TABLE `tb_gift` (

 `gift_id` bigint NOT NULL AUTO_INCREMENT COMMENT '礼物ID',

 `gift_name` varchar(50) NOT NULL COMMENT '礼物名称',

 `gift_image` varchar(255) NOT NULL COMMENT '礼物图片URL',

 `gift_animation` varchar(255) DEFAULT NULL COMMENT '礼物动画URL',

 `gift_price` int NOT NULL COMMENT '礼物价格（虚拟币）',

 `gift_type` tinyint NOT NULL DEFAULT '1' COMMENT '礼物类型：1-普通礼物，2-特效礼物，3-限时礼物',

 `gift_status` tinyint NOT NULL DEFAULT '1' COMMENT '礼物状态：0-下架，1-上架',

 `start_time` datetime DEFAULT NULL COMMENT '上架开始时间',

 `end_time` datetime DEFAULT NULL COMMENT '上架结束时间',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`gift_id`),

 KEY `idx_gift_status` (`gift_status`),

 KEY `idx_gift_price` (`gift_price`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='礼物表';

#### 2.6 礼物赠送记录表（tb_gift_record）

CREATE TABLE `tb_gift_record` (

 `record_id` bigint NOT NULL AUTO_INCREMENT COMMENT '记录ID',

 `sender_id` bigint NOT NULL COMMENT '赠送者ID',

 `receiver_id` bigint NOT NULL COMMENT '接收者ID',

 `gift_id` bigint NOT NULL COMMENT '礼物ID',

 `gift_count` int NOT NULL DEFAULT '1' COMMENT '礼物数量',

 `total_price` int NOT NULL COMMENT '总价（虚拟币）',

 `scene_type` tinyint DEFAULT NULL COMMENT '赠送场景：1-个人主页，2-动态评论，3-语音房，4-游戏中',

 `scene_id` bigint DEFAULT NULL COMMENT '场景ID',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 PRIMARY KEY (`record_id`),

 KEY `idx_sender_id` (`sender_id`),

 KEY `idx_receiver_id` (`receiver_id`),

 KEY `idx_gift_id` (`gift_id`),

 KEY `idx_created_at` (`created_at`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='礼物赠送记录表';

### 3. 红娘服务表组

#### 3.1 红娘信息表（tb_matchmaker）

CREATE TABLE `tb_matchmaker` (

 `matchmaker_id` bigint NOT NULL AUTO_INCREMENT COMMENT '红娘ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `real_name` varchar(50) NOT NULL COMMENT '真实姓名',

 `id_card_no` varchar(128) NOT NULL COMMENT '身份证号（加密存储）',

 `phone` varchar(20) NOT NULL COMMENT '联系电话',

 `matchmaker_level` tinyint NOT NULL DEFAULT '1' COMMENT '红娘等级：1-预备红娘，2-正式红娘，3-金牌红娘',

 `service_area` varchar(200) DEFAULT NULL COMMENT '服务区域',

 `service_years` int DEFAULT NULL COMMENT '从业年限',

 `success_count` int NOT NULL DEFAULT '0' COMMENT '成功牵线次数',

 `introduction` text COMMENT '个人介绍',

 `certification` varchar(255) DEFAULT NULL COMMENT '资质证书URL',

 `matchmaker_status` tinyint NOT NULL DEFAULT '1' COMMENT '红娘状态：0-冻结，1-正常',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`matchmaker_id`),

 UNIQUE KEY `idx_user_id` (`user_id`),

 KEY `idx_matchmaker_level` (`matchmaker_level`),

 KEY `idx_service_area` (`service_area`(191)),

 KEY `idx_success_count` (`success_count`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='红娘信息表';

#### 3.2 红娘服务申请表（tb_matchmaker_application）

CREATE TABLE `tb_matchmaker_application` (

 `application_id` bigint NOT NULL AUTO_INCREMENT COMMENT '申请ID',

 `user_id` bigint NOT NULL COMMENT '申请用户ID',

 `real_name` varchar(50) NOT NULL COMMENT '真实姓名',

 `phone` varchar(20) NOT NULL COMMENT '联系电话',

 `id_card_no` varchar(128) NOT NULL COMMENT '身份证号（加密存储）',

 `id_card_front` varchar(255) NOT NULL COMMENT '身份证正面照片URL',

 `id_card_back` varchar(255) NOT NULL COMMENT '身份证背面照片URL',

 `service_area` varchar(200) DEFAULT NULL COMMENT '期望服务区域',

 `introduction` text COMMENT '个人介绍',

 `experience` text COMMENT '相关经验',

 `application_status` tinyint NOT NULL DEFAULT '0' COMMENT '申请状态：0-待审核，1-已通过，2-已拒绝',

 `reject_reason` varchar(200) DEFAULT NULL COMMENT '拒绝原因',

 `reviewer_id` bigint DEFAULT NULL COMMENT '审核人ID',

 `review_time` datetime DEFAULT NULL COMMENT '审核时间',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`application_id`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_application_status` (`application_status`),

 KEY `idx_created_at` (`created_at`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='红娘服务申请表';

#### 3.3 牵线申请表（tb_matchmaking_request）

CREATE TABLE `tb_matchmaking_request` (

 `request_id` bigint NOT NULL AUTO_INCREMENT COMMENT '申请ID',

 `user_id` bigint NOT NULL COMMENT '申请用户ID',

 `target_user_id` bigint NOT NULL COMMENT '目标用户ID',

 `matchmaker_id` bigint DEFAULT NULL COMMENT '红娘ID（为空表示系统分配）',

 `request_message` varchar(500) DEFAULT NULL COMMENT '申请留言',

 `request_status` tinyint NOT NULL DEFAULT '0' COMMENT '申请状态：0-待处理，1-已接受，2-已拒绝，3-已完成',

 `reject_reason` varchar(200) DEFAULT NULL COMMENT '拒绝原因',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`request_id`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_target_user_id` (`target_user_id`),

 KEY `idx_matchmaker_id` (`matchmaker_id`),

 KEY `idx_request_status` (`request_status`),

 KEY `idx_created_at` (`created_at`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='牵线申请表';

#### 3.4 约会安排表（tb_date_arrangement）

CREATE TABLE `tb_date_arrangement` (

 `arrangement_id` bigint NOT NULL AUTO_INCREMENT COMMENT '安排ID',

 `request_id` bigint NOT NULL COMMENT '牵线申请ID',

 `matchmaker_id` bigint NOT NULL COMMENT '红娘ID',

 `user_id` bigint NOT NULL COMMENT '用户A的ID',

 `target_user_id` bigint NOT NULL COMMENT '用户B的ID',

 `date_time` datetime NOT NULL COMMENT '约会时间',

 `date_location` varchar(200) NOT NULL COMMENT '约会地点',

 `date_type` tinyint NOT NULL DEFAULT '1' COMMENT '约会类型：1-咖啡厅，2-餐厅，3-电影院，4-其他',

 `date_plan` text COMMENT '约会计划详情',

 `user_a_confirm` tinyint NOT NULL DEFAULT '0' COMMENT '用户A确认状态：0-待确认，1-已确认，2-已拒绝',

 `user_b_confirm` tinyint NOT NULL DEFAULT '0' COMMENT '用户B确认状态：0-待确认，1-已确认，2-已拒绝',

 `arrangement_status` tinyint NOT NULL DEFAULT '0' COMMENT '安排状态：0-待确认，1-已确认，2-已取消，3-已完成',

 `cancel_reason` varchar(200) DEFAULT NULL COMMENT '取消原因',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`arrangement_id`),

 KEY `idx_request_id` (`request_id`),

 KEY `idx_matchmaker_id` (`matchmaker_id`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_target_user_id` (`target_user_id`),

 KEY `idx_date_time` (`date_time`),

 KEY `idx_arrangement_status` (`arrangement_status`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='约会安排表';

#### 3.5 约会反馈表（tb_date_feedback）

CREATE TABLE `tb_date_feedback` (

 `feedback_id` bigint NOT NULL AUTO_INCREMENT COMMENT '反馈ID',

 `arrangement_id` bigint NOT NULL COMMENT '约会安排ID',

 `user_id` bigint NOT NULL COMMENT '反馈用户ID',

 `satisfaction_score` tinyint NOT NULL COMMENT '满意度评分：1-5分',

 `feedback_content` text COMMENT '反馈内容',

 `matchmaker_score` tinyint DEFAULT NULL COMMENT '红娘服务评分：1-5分',

 `is_willing_next` tinyint NOT NULL DEFAULT '0' COMMENT '是否愿意再次约会：0-否，1-是',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`feedback_id`),

 UNIQUE KEY `idx_arrangement_user` (`arrangement_id`,`user_id`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_satisfaction_score` (`satisfaction_score`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='约会反馈表';

#### 3.6 红娘业绩表（tb_matchmaker_performance）

CREATE TABLE `tb_matchmaker_performance` (

 `performance_id` bigint NOT NULL AUTO_INCREMENT COMMENT '业绩ID',

 `matchmaker_id` bigint NOT NULL COMMENT '红娘ID',

 `year` int NOT NULL COMMENT '年份',

 `month` int NOT NULL COMMENT '月份',

 `request_count` int NOT NULL DEFAULT '0' COMMENT '接单数量',

 `arrangement_count` int NOT NULL DEFAULT '0' COMMENT '安排约会数量',

 `success_count` int NOT NULL DEFAULT '0' COMMENT '成功牵线数量',

 `satisfaction_avg` decimal(3,2) NOT NULL DEFAULT '0.00' COMMENT '满意度平均分',

 `commission_amount` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '佣金金额',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`performance_id`),

 UNIQUE KEY `idx_matchmaker_month` (`matchmaker_id`,`year`,`month`),

 KEY `idx_success_count` (`success_count`),

 KEY `idx_satisfaction_avg` (`satisfaction_avg`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='红娘业绩表';

### 4. 娱乐互动表组

#### 4.1 游戏基础信息表（tb_game）

CREATE TABLE `tb_game` (

 `game_id` bigint NOT NULL AUTO_INCREMENT COMMENT '游戏ID',

 `game_name` varchar(50) NOT NULL COMMENT '游戏名称',

 `game_desc` varchar(500) DEFAULT NULL COMMENT '游戏描述',

 `game_icon` varchar(255) DEFAULT NULL COMMENT '游戏图标URL',

 `game_type` tinyint NOT NULL COMMENT '游戏类型：1-性格测试，2-默契挑战，3-互动游戏，4-其他',

 `player_min` int NOT NULL DEFAULT '2' COMMENT '最少参与人数',

 `player_max` int NOT NULL DEFAULT '2' COMMENT '最多参与人数',

 `duration` int DEFAULT NULL COMMENT '预计游戏时长(分钟)',

 `is_vip` tinyint NOT NULL DEFAULT '0' COMMENT '是否VIP专属：0-否，1-是',

 `game_status` tinyint NOT NULL DEFAULT '1' COMMENT '游戏状态：0-下线，1-上线',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`game_id`),

 KEY `idx_game_type` (`game_type`),

 KEY `idx_is_vip` (`is_vip`),

 KEY `idx_game_status` (`game_status`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='游戏基础信息表';

#### 4.2 游戏房间表（tb_game_room）

CREATE TABLE `tb_game_room` (

 `room_id` bigint NOT NULL AUTO_INCREMENT COMMENT '房间ID',

 `game_id` bigint NOT NULL COMMENT '游戏ID',

 `creator_id` bigint NOT NULL COMMENT '创建者ID',

 `room_name` varchar(50) DEFAULT NULL COMMENT '房间名称',

 `room_password` varchar(20) DEFAULT NULL COMMENT '房间密码',

 `max_players` int NOT NULL DEFAULT '2' COMMENT '最大玩家数',

 `current_players` int NOT NULL DEFAULT '1' COMMENT '当前玩家数',

 `room_status` tinyint NOT NULL DEFAULT '0' COMMENT '房间状态：0-等待中，1-游戏中，2-已结束',

 `start_time` datetime DEFAULT NULL COMMENT '开始时间',

 `end_time` datetime DEFAULT NULL COMMENT '结束时间',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`room_id`),

 KEY `idx_game_id` (`game_id`),

 KEY `idx_creator_id` (`creator_id`),

 KEY `idx_room_status` (`room_status`),

 KEY `idx_created_at` (`created_at`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='游戏房间表';

#### 4.3 游戏参与记录表（tb_game_player）

CREATE TABLE `tb_game_player` (

 `record_id` bigint NOT NULL AUTO_INCREMENT COMMENT '记录ID',

 `room_id` bigint NOT NULL COMMENT '房间ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `join_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '加入时间',

 `leave_time` datetime DEFAULT NULL COMMENT '离开时间',

 `player_status` tinyint NOT NULL DEFAULT '1' COMMENT '玩家状态：0-离开，1-在线',

 `score` int DEFAULT NULL COMMENT '游戏得分',

 `rank` int DEFAULT NULL COMMENT '游戏排名',

 PRIMARY KEY (`record_id`),

 UNIQUE KEY `idx_room_user` (`room_id`,`user_id`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_player_status` (`player_status`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='游戏参与记录表';

#### 4.4 游戏结果表（tb_game_result）

CREATE TABLE `tb_game_result` (

 `result_id` bigint NOT NULL AUTO_INCREMENT COMMENT '结果ID',

 `room_id` bigint NOT NULL COMMENT '房间ID',

 `result_type` tinyint NOT NULL COMMENT '结果类型：1-性格测试结果，2-匹配度结果，3-互动游戏结果',

 `result_data` json NOT NULL COMMENT '结果数据（JSON格式）',

 `match_score` int DEFAULT NULL COMMENT '匹配得分',

 `match_level` tinyint DEFAULT NULL COMMENT '匹配等级：1-5级',

 `result_summary` varchar(500) DEFAULT NULL COMMENT '结果摘要',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 PRIMARY KEY (`result_id`),

 KEY `idx_room_id` (`room_id`),

 KEY `idx_result_type` (`result_type`),

 KEY `idx_match_score` (`match_score`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='游戏结果表';

#### 4.5 语音房表（tb_voice_room）

CREATE TABLE `tb_voice_room` (

 `room_id` bigint NOT NULL AUTO_INCREMENT COMMENT '房间ID',

 `creator_id` bigint NOT NULL COMMENT '创建者ID',

 `room_name` varchar(50) NOT NULL COMMENT '房间名称',

 `room_cover` varchar(255) DEFAULT NULL COMMENT '房间封面URL',

 `room_desc` varchar(200) DEFAULT NULL COMMENT '房间描述',

 `room_type` tinyint NOT NULL DEFAULT '1' COMMENT '房间类型：1-闲聊，2-音乐，3-情感话题，4-其他',

 `max_users` int NOT NULL DEFAULT '20' COMMENT '最大用户数',

 `current_users` int NOT NULL DEFAULT '1' COMMENT '当前用户数',

 `room_status` tinyint NOT NULL DEFAULT '1' COMMENT '房间状态：0-关闭，1-开放',

 `is_private` tinyint NOT NULL DEFAULT '0' COMMENT '是否私密：0-公开，1-私密',

 `room_password` varchar(20) DEFAULT NULL COMMENT '房间密码',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`room_id`),

 KEY `idx_creator_id` (`creator_id`),

 KEY `idx_room_type` (`room_type`),

 KEY `idx_room_status` (`room_status`),

 KEY `idx_created_at` (`created_at`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='语音房表';

#### 4.6 语音房用户表（tb_voice_room_user）

CREATE TABLE `tb_voice_room_user` (

 `record_id` bigint NOT NULL AUTO_INCREMENT COMMENT '记录ID',

 `room_id` bigint NOT NULL COMMENT '房间ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `user_role` tinyint NOT NULL DEFAULT '0' COMMENT '用户角色：0-观众，1-主持人，2-嘉宾',

 `mic_status` tinyint NOT NULL DEFAULT '0' COMMENT '麦克风状态：0-关闭，1-开启',

 `join_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '加入时间',

 `leave_time` datetime DEFAULT NULL COMMENT '离开时间',

 `is_online` tinyint NOT NULL DEFAULT '1' COMMENT '是否在线：0-离线，1-在线',

 PRIMARY KEY (`record_id`),

 UNIQUE KEY `idx_room_user` (`room_id`,`user_id`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_user_role` (`user_role`),

 KEY `idx_is_online` (`is_online`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='语音房用户表';

### 5. 内容管理表组

#### 5.1 动态表（tb_moment）

CREATE TABLE `tb_moment` (

 `moment_id` bigint NOT NULL AUTO_INCREMENT COMMENT '动态ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `content` varchar(1000) DEFAULT NULL COMMENT '动态内容',

 `location` varchar(100) DEFAULT NULL COMMENT '位置信息',

 `visibility` tinyint NOT NULL DEFAULT '1' COMMENT '可见范围：1-公开，2-仅关注者可见，3-仅自己可见',

 `like_count` int NOT NULL DEFAULT '0' COMMENT '点赞数',

 `comment_count` int NOT NULL DEFAULT '0' COMMENT '评论数',

 `view_count` int NOT NULL DEFAULT '0' COMMENT '浏览数',

 `status` tinyint NOT NULL DEFAULT '1' COMMENT '状态：0-已删除，1-正常，2-已屏蔽',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`moment_id`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_status` (`status`),

 KEY `idx_created_at` (`created_at`),

 KEY `idx_like_count` (`like_count`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='动态表';

#### 5.2 动态媒体表（tb_moment_media）

CREATE TABLE `tb_moment_media` (

 `media_id` bigint NOT NULL AUTO_INCREMENT COMMENT '媒体ID',

 `moment_id` bigint NOT NULL COMMENT '动态ID',

 `media_type` tinyint NOT NULL COMMENT '媒体类型：1-图片，2-视频，3-音频',

 `media_url` varchar(255) NOT NULL COMMENT '媒体URL',

 `cover_url` varchar(255) DEFAULT NULL COMMENT '封面URL（视频用）',

 `width` int DEFAULT NULL COMMENT '宽度',

 `height` int DEFAULT NULL COMMENT '高度',

 `duration` int DEFAULT NULL COMMENT '时长（秒）',

 `sort_order` int NOT NULL DEFAULT '0' COMMENT '排序顺序',

 PRIMARY KEY (`media_id`),

 KEY `idx_moment_id` (`moment_id`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='动态媒体表';

#### 5.3 评论表（tb_comment）

CREATE TABLE `tb_comment` (

 `comment_id` bigint NOT NULL AUTO_INCREMENT COMMENT '评论ID',

 `target_id` bigint NOT NULL COMMENT '评论目标ID',

 `target_type` tinyint NOT NULL COMMENT '评论类型：1-动态，2-语音房，3-游戏',

 `user_id` bigint NOT NULL COMMENT '评论用户ID',

 `content` varchar(500) NOT NULL COMMENT '评论内容',

 `parent_id` bigint DEFAULT NULL COMMENT '父评论ID（回复评论时使用）',

 `reply_user_id` bigint DEFAULT NULL COMMENT '回复用户ID',

 `like_count` int NOT NULL DEFAULT '0' COMMENT '点赞数',

 `status` tinyint NOT NULL DEFAULT '1' COMMENT '状态：0-已删除，1-正常，2-已屏蔽',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`comment_id`),

 KEY `idx_target` (`target_id`,`target_type`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_parent_id` (`parent_id`),

 KEY `idx_status` (`status`),

 KEY `idx_created_at` (`created_at`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='评论表';

#### 5.4 话题表（tb_topic）

CREATE TABLE `tb_topic` (

 `topic_id` bigint NOT NULL AUTO_INCREMENT COMMENT '话题ID',

 `topic_name` varchar(50) NOT NULL COMMENT '话题名称',

 `topic_desc` varchar(200) DEFAULT NULL COMMENT '话题描述',

 `topic_cover` varchar(255) DEFAULT NULL COMMENT '话题封面URL',

 `topic_type` tinyint NOT NULL DEFAULT '1' COMMENT '话题类型：1-情感，2-兴趣，3-生活，4-其他',

 `moment_count` int NOT NULL DEFAULT '0' COMMENT '动态数',

 `view_count` int NOT NULL DEFAULT '0' COMMENT '浏览数',

 `is_hot` tinyint NOT NULL DEFAULT '0' COMMENT '是否热门：0-否，1-是',

 `sort_order` int NOT NULL DEFAULT '0' COMMENT '排序顺序',

 `status` tinyint NOT NULL DEFAULT '1' COMMENT '状态：0-已删除，1-正常，2-已屏蔽',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`topic_id`),

 UNIQUE KEY `idx_topic_name` (`topic_name`),

 KEY `idx_topic_type` (`topic_type`),

 KEY `idx_is_hot` (`is_hot`),

 KEY `idx_sort_order` (`sort_order`),

 KEY `idx_status` (`status`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='话题表';

#### 5.5 动态话题关联表（tb_moment_topic）

CREATE TABLE `tb_moment_topic` (

 `id` bigint NOT NULL AUTO_INCREMENT COMMENT '主键ID',

 `moment_id` bigint NOT NULL COMMENT '动态ID',

 `topic_id` bigint NOT NULL COMMENT '话题ID',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 PRIMARY KEY (`id`),

 UNIQUE KEY `idx_moment_topic` (`moment_id`,`topic_id`),

 KEY `idx_topic_id` (`topic_id`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='动态话题关联表';

#### 5.6 社群表（tb_community）

CREATE TABLE `tb_community` (

 `community_id` bigint NOT NULL AUTO_INCREMENT COMMENT '社群ID',

 `community_name` varchar(50) NOT NULL COMMENT '社群名称',

 `community_desc` varchar(500) DEFAULT NULL COMMENT '社群描述',

 `community_icon` varchar(255) DEFAULT NULL COMMENT '社群图标URL',

 `community_cover` varchar(255) DEFAULT NULL COMMENT '社群封面URL',

 `creator_id` bigint NOT NULL COMMENT '创建者ID',

 `community_type` tinyint NOT NULL DEFAULT '1' COMMENT '社群类型：1-兴趣，2-地域，3-情感，4-其他',

 `member_count` int NOT NULL DEFAULT '1' COMMENT '成员数量',

 `post_count` int NOT NULL DEFAULT '0' COMMENT '帖子数量',

 `join_type` tinyint NOT NULL DEFAULT '1' COMMENT '加入方式：1-自由加入，2-审核加入，3-邀请加入',

 `status` tinyint NOT NULL DEFAULT '1' COMMENT '状态：0-已解散，1-正常，2-已屏蔽',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`community_id`),

 KEY `idx_creator_id` (`creator_id`),

 KEY `idx_community_type` (`community_type`),

 KEY `idx_status` (`status`),

 KEY `idx_member_count` (`member_count`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='社群表';

#### 5.7 社群成员表（tb_community_member）

CREATE TABLE `tb_community_member` (

 `member_id` bigint NOT NULL AUTO_INCREMENT COMMENT '成员ID',

 `community_id` bigint NOT NULL COMMENT '社群ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `member_role` tinyint NOT NULL DEFAULT '0' COMMENT '成员角色：0-普通成员，1-管理员，2-群主',

 `join_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '加入时间',

 `status` tinyint NOT NULL DEFAULT '1' COMMENT '状态：0-已退出，1-正常，2-已禁言',

 PRIMARY KEY (`member_id`),

 UNIQUE KEY `idx_community_user` (`community_id`,`user_id`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_member_role` (`member_role`),

 KEY `idx_status` (`status`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='社群成员表';

### 6. 交易与支付表组

#### 6.1 会员订单表（tb_vip_order）

CREATE TABLE `tb_vip_order` (

 `order_id` bigint NOT NULL AUTO_INCREMENT COMMENT '订单ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `order_no` varchar(64) NOT NULL COMMENT '订单编号',

 `vip_type` tinyint NOT NULL COMMENT 'VIP类型：1-月度，2-季度，3-年度',

 `amount` decimal(10,2) NOT NULL COMMENT '订单金额',

 `pay_amount` decimal(10,2) NOT NULL COMMENT '支付金额',

 `discount_amount` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '优惠金额',

 `pay_type` tinyint DEFAULT NULL COMMENT '支付方式：1-微信，2-支付宝，3-苹果支付，4-其他',

 `pay_time` datetime DEFAULT NULL COMMENT '支付时间',

 `transaction_id` varchar(64) DEFAULT NULL COMMENT '支付平台交易号',

 `start_time` datetime DEFAULT NULL COMMENT 'VIP开始时间',

 `end_time` datetime DEFAULT NULL COMMENT 'VIP结束时间',

 `order_status` tinyint NOT NULL DEFAULT '0' COMMENT '订单状态：0-待支付，1-已支付，2-已取消，3-已退款',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`order_id`),

 UNIQUE KEY `idx_order_no` (`order_no`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_order_status` (`order_status`),

 KEY `idx_created_at` (`created_at`),

 KEY `idx_pay_time` (`pay_time`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='会员订单表';

#### 6.2 虚拟币充值表（tb_coin_recharge

CREATE TABLE `tb_coin_recharge` (

 `recharge_id` bigint NOT NULL AUTO_INCREMENT COMMENT '充值ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `order_no` varchar(64) NOT NULL COMMENT '订单编号',

 `coin_amount` int NOT NULL COMMENT '充值虚拟币数量',

 `pay_amount` decimal(10,2) NOT NULL COMMENT '支付金额',

 `bonus_amount` int NOT NULL DEFAULT '0' COMMENT '赠送虚拟币数量',

 `pay_type` tinyint DEFAULT NULL COMMENT '支付方式：1-微信，2-支付宝，3-苹果支付，4-其他',

 `pay_time` datetime DEFAULT NULL COMMENT '支付时间',

 `transaction_id` varchar(64) DEFAULT NULL COMMENT '支付平台交易号',

 `order_status` tinyint NOT NULL DEFAULT '0' COMMENT '订单状态：0-待支付，1-已支付，2-已取消，3-已退款',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`recharge_id`),

 UNIQUE KEY `idx_order_no` (`order_no`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_order_status` (`order_status`),

 KEY `idx_created_at` (`created_at`),

 KEY `idx_pay_time` (`pay_time`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='虚拟币充值表';

#### 6.3 用户钱包表（tb_user_wallet）

CREATE TABLE `tb_user_wallet` (

 `wallet_id` bigint NOT NULL AUTO_INCREMENT COMMENT '钱包ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `coin_balance` int NOT NULL DEFAULT '0' COMMENT '虚拟币余额',

 `total_recharge` int NOT NULL DEFAULT '0' COMMENT '累计充值虚拟币',

 `total_consume` int NOT NULL DEFAULT '0' COMMENT '累计消费虚拟币',

 `cash_balance` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '现金余额',

 `total_income` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '累计收入',

 `total_withdraw` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '累计提现',

 `wallet_status` tinyint NOT NULL DEFAULT '1' COMMENT '钱包状态：0-冻结，1-正常',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`wallet_id`),

 UNIQUE KEY `idx_user_id` (`user_id`),

 KEY `idx_wallet_status` (`wallet_status`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户钱包表';

#### 6.4 钱包交易记录表（tb_wallet_transaction）

CREATE TABLE `tb_wallet_transaction` (

 `transaction_id` bigint NOT NULL AUTO_INCREMENT COMMENT '交易ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `transaction_type` tinyint NOT NULL COMMENT '交易类型：1-充值，2-消费，3-收入，4-提现，5-退款',

 `transaction_amount` decimal(10,2) NOT NULL COMMENT '交易金额',

 `coin_amount` int DEFAULT NULL COMMENT '虚拟币数量',

 `balance` decimal(10,2) DEFAULT NULL COMMENT '交易后余额',

 `coin_balance` int DEFAULT NULL COMMENT '交易后虚拟币余额',

 `transaction_desc` varchar(200) NOT NULL COMMENT '交易描述',

 `related_id` varchar(64) DEFAULT NULL COMMENT '关联ID（订单号/提现单号等）',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 PRIMARY KEY (`transaction_id`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_transaction_type` (`transaction_type`),

 KEY `idx_created_at` (`created_at`),

 KEY `idx_related_id` (`related_id`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='钱包交易记录表';

#### 6.5 提现申请表（tb_withdraw_application）

CREATE TABLE `tb_withdraw_application` (

 `withdraw_id` bigint NOT NULL AUTO_INCREMENT COMMENT '提现ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `withdraw_no` varchar(64) NOT NULL COMMENT '提现单号',

 `withdraw_amount` decimal(10,2) NOT NULL COMMENT '提现金额',

 `fee_amount` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '手续费',

 `actual_amount` decimal(10,2) NOT NULL COMMENT '实际到账金额',

 `withdraw_type` tinyint NOT NULL COMMENT '提现方式：1-微信，2-支付宝，3-银行卡',

 `withdraw_account` varchar(64) NOT NULL COMMENT '提现账号',

 `account_name` varchar(50) NOT NULL COMMENT '账户名',

 `bank_name` varchar(50) DEFAULT NULL COMMENT '银行名称',

 `withdraw_status` tinyint NOT NULL DEFAULT '0' COMMENT '提现状态：0-审核中，1-已通过，2-已拒绝，3-已打款，4-已取消',

 `reject_reason` varchar(200) DEFAULT NULL COMMENT '拒绝原因',

 `reviewer_id` bigint DEFAULT NULL COMMENT '审核人ID',

 `review_time` datetime DEFAULT NULL COMMENT '审核时间',

 `payment_time` datetime DEFAULT NULL COMMENT '打款时间',

 `payment_proof` varchar(255) DEFAULT NULL COMMENT '打款凭证',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`withdraw_id`),

 UNIQUE KEY `idx_withdraw_no` (`withdraw_no`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_withdraw_status` (`withdraw_status`),

 KEY `idx_created_at` (`created_at`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='提现申请表';

#### 6.6 红娘服务订单表（tb_matchmaker_order）

CREATE TABLE `tb_matchmaker_order` (

 `order_id` bigint NOT NULL AUTO_INCREMENT COMMENT '订单ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `matchmaker_id` bigint NOT NULL COMMENT '红娘ID',

 `order_no` varchar(64) NOT NULL COMMENT '订单编号',

 `service_type` tinyint NOT NULL COMMENT '服务类型：1-单次牵线，2-包月服务，3-高端定制',

 `service_desc` varchar(200) NOT NULL COMMENT '服务描述',

 `amount` decimal(10,2) NOT NULL COMMENT '订单金额',

 `pay_amount` decimal(10,2) NOT NULL COMMENT '支付金额',

 `discount_amount` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '优惠金额',

 `pay_type` tinyint DEFAULT NULL COMMENT '支付方式：1-微信，2-支付宝，3-虚拟币，4-其他',

 `pay_time` datetime DEFAULT NULL COMMENT '支付时间',

 `transaction_id` varchar(64) DEFAULT NULL COMMENT '支付平台交易号',

 `service_start_time` datetime DEFAULT NULL COMMENT '服务开始时间',

 `service_end_time` datetime DEFAULT NULL COMMENT '服务结束时间',

 `order_status` tinyint NOT NULL DEFAULT '0' COMMENT '订单状态：0-待支付，1-已支付，2-已取消，3-已退款，4-已完成',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`order_id`),

 UNIQUE KEY `idx_order_no` (`order_no`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_matchmaker_id` (`matchmaker_id`),

 KEY `idx_order_status` (`order_status`),

 KEY `idx_created_at` (`created_at`),

 KEY `idx_pay_time` (`pay_time`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='红娘服务订单表';

#### 6.7 邀请记录表（tb_invitation）

CREATE TABLE `tb_invitation` (

 `invitation_id` bigint NOT NULL AUTO_INCREMENT COMMENT '邀请ID',

 `inviter_id` bigint NOT NULL COMMENT '邀请人ID',

 `invitee_id` bigint DEFAULT NULL COMMENT '被邀请人ID',

 `invitation_code` varchar(20) NOT NULL COMMENT '邀请码',

 `invitation_link` varchar(255) NOT NULL COMMENT '邀请链接',

 `invitation_type` tinyint NOT NULL DEFAULT '1' COMMENT '邀请类型：1-普通邀请，2-红娘邀请',

 `invitation_status` tinyint NOT NULL DEFAULT '0' COMMENT '邀请状态：0-未使用，1-已使用，2-已过期',

 `register_time` datetime DEFAULT NULL COMMENT '注册时间',

 `reward_status` tinyint NOT NULL DEFAULT '0' COMMENT '奖励状态：0-未发放，1-已发放',

 `reward_amount` decimal(10,2) DEFAULT NULL COMMENT '奖励金额',

 `reward_coin` int DEFAULT NULL COMMENT '奖励虚拟币',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`invitation_id`),

 UNIQUE KEY `idx_invitation_code` (`invitation_code`),

 KEY `idx_inviter_id` (`inviter_id`),

 KEY `idx_invitee_id` (`invitee_id`),

 KEY `idx_invitation_status` (`invitation_status`),

 KEY `idx_created_at` (`created_at`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='邀请记录表';

### 7. 系统配置表组

#### 7.1 系统配置表（tb_system_config）

CREATE TABLE `tb_system_config` (

 `config_id` bigint NOT NULL AUTO_INCREMENT COMMENT '配置ID',

 `config_key` varchar(50) NOT NULL COMMENT '配置键',

 `config_value` varchar(2000) NOT NULL COMMENT '配置值',

 `config_desc` varchar(200) DEFAULT NULL COMMENT '配置描述',

 `config_type` tinyint NOT NULL DEFAULT '1' COMMENT '配置类型：1-系统参数，2-业务参数，3-算法参数',

 `is_editable` tinyint NOT NULL DEFAULT '1' COMMENT '是否可编辑：0-否，1-是',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`config_id`),

 UNIQUE KEY `idx_config_key` (`config_key`),

 KEY `idx_config_type` (`config_type`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='系统配置表';

#### 7.2 管理员表（tb_admin）

CREATE TABLE `tb_admin` (

 `admin_id` bigint NOT NULL AUTO_INCREMENT COMMENT '管理员ID',

 `username` varchar(50) NOT NULL COMMENT '用户名',

 `password` varchar(128) NOT NULL COMMENT '密码（加密存储）',

 `real_name` varchar(50) DEFAULT NULL COMMENT '真实姓名',

 `phone` varchar(20) DEFAULT NULL COMMENT '手机号',

 `email` varchar(100) DEFAULT NULL COMMENT '邮箱',

 `avatar_url` varchar(255) DEFAULT NULL COMMENT '头像URL',

 `role_id` bigint NOT NULL COMMENT '角色ID',

 `admin_status` tinyint NOT NULL DEFAULT '1' COMMENT '状态：0-禁用，1-启用',

 `last_login_time` datetime DEFAULT NULL COMMENT '最后登录时间',

 `last_login_ip` varchar(64) DEFAULT NULL COMMENT '最后登录IP',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`admin_id`),

 UNIQUE KEY `idx_username` (`username`),

 KEY `idx_role_id` (`role_id`),

 KEY `idx_admin_status` (`admin_status`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='管理员表';

#### 7.3 角色表（tb_role）

CREATE TABLE `tb_role` (

 `role_id` bigint NOT NULL AUTO_INCREMENT COMMENT '角色ID',

 `role_name` varchar(50) NOT NULL COMMENT '角色名称',

 `role_desc` varchar(200) DEFAULT NULL COMMENT '角色描述',

 `role_status` tinyint NOT NULL DEFAULT '1' COMMENT '状态：0-禁用，1-启用',

 `is_system` tinyint NOT NULL DEFAULT '0' COMMENT '是否系统角色：0-否，1-是',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`role_id`),

 UNIQUE KEY `idx_role_name` (`role_name`),

 KEY `idx_role_status` (`role_status`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='角色表';

#### 7.4 权限表（tb_permission）

CREATE TABLE `tb_permission` (

 `permission_id` bigint NOT NULL AUTO_INCREMENT COMMENT '权限ID',

 `permission_name` varchar(50) NOT NULL COMMENT '权限名称',

 `permission_key` varchar(50) NOT NULL COMMENT '权限标识',

 `permission_desc` varchar(200) DEFAULT NULL COMMENT '权限描述',

 `parent_id` bigint DEFAULT NULL COMMENT '父权限ID',

 `permission_type` tinyint NOT NULL DEFAULT '1' COMMENT '权限类型：1-菜单，2-按钮，3-接口',

 `path` varchar(200) DEFAULT NULL COMMENT '路径（菜单使用）',

 `component` varchar(200) DEFAULT NULL COMMENT '组件（菜单使用）',

 `icon` varchar(50) DEFAULT NULL COMMENT '图标（菜单使用）',

 `sort_order` int NOT NULL DEFAULT '0' COMMENT '排序顺序',

 `is_visible` tinyint NOT NULL DEFAULT '1' COMMENT '是否可见：0-否，1-是',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`permission_id`),

 UNIQUE KEY `idx_permission_key` (`permission_key`),

 KEY `idx_parent_id` (`parent_id`),

 KEY `idx_permission_type` (`permission_type`),

 KEY `idx_sort_order` (`sort_order`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='权限表';

#### 7.5 角色权限关联表（tb_role_permission）

CREATE TABLE `tb_role_permission` (

 `id` bigint NOT NULL AUTO_INCREMENT COMMENT '主键ID',

 `role_id` bigint NOT NULL COMMENT '角色ID',

 `permission_id` bigint NOT NULL COMMENT '权限ID',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 PRIMARY KEY (`id`),

 UNIQUE KEY `idx_role_permission` (`role_id`,`permission_id`),

 KEY `idx_permission_id` (`permission_id`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='角色权限关联表';

#### 7.6 操作日志表（tb_operation_log）

CREATE TABLE `tb_operation_log` (

 `log_id` bigint NOT NULL AUTO_INCREMENT COMMENT '日志ID',

 `operator_id` bigint DEFAULT NULL COMMENT '操作人ID',

 `operator_type` tinyint NOT NULL DEFAULT '1' COMMENT '操作人类型：1-管理员，2-用户，3-系统',

 `operator_name` varchar(50) DEFAULT NULL COMMENT '操作人名称',

 `module` varchar(50) NOT NULL COMMENT '操作模块',

 `operation` varchar(50) NOT NULL COMMENT '操作类型',

 `method` varchar(100) DEFAULT NULL COMMENT '请求方法',

 `params` text COMMENT '请求参数',

 `ip` varchar(64) DEFAULT NULL COMMENT '操作IP',

 `user_agent` varchar(500) DEFAULT NULL COMMENT '用户代理',

 `status` tinyint NOT NULL DEFAULT '1' COMMENT '操作状态：0-失败，1-成功',

 `error_msg` varchar(500) DEFAULT NULL COMMENT '错误消息',

 `execution_time` int DEFAULT NULL COMMENT '执行时长(毫秒)',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 PRIMARY KEY (`log_id`),

 KEY `idx_operator_id` (`operator_id`,`operator_type`),

 KEY `idx_module` (`module`),

 KEY `idx_operation` (`operation`),

 KEY `idx_status` (`status`),

 KEY `idx_created_at` (`created_at`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='操作日志表';

#### 7.7 系统公告表（tb_announcement）

CREATE TABLE `tb_announcement` (

 `announcement_id` bigint NOT NULL AUTO_INCREMENT COMMENT '公告ID',

 `title` varchar(100) NOT NULL COMMENT '公告标题',

 `content` text NOT NULL COMMENT '公告内容',

 `announcement_type` tinyint NOT NULL DEFAULT '1' COMMENT '公告类型：1-系统公告，2-活动公告，3-维护公告',

 `target_type` tinyint NOT NULL DEFAULT '1' COMMENT '目标类型：1-全部用户，2-特定用户组，3-管理员',

 `target_ids` varchar(1000) DEFAULT NULL COMMENT '目标ID列表（JSON格式）',

 `start_time` datetime NOT NULL COMMENT '开始时间',

 `end_time` datetime NOT NULL COMMENT '结束时间',

 `is_top` tinyint NOT NULL DEFAULT '0' COMMENT '是否置顶：0-否，1-是',

 `status` tinyint NOT NULL DEFAULT '1' COMMENT '状态：0-下线，1-上线',

 `creator_id` bigint NOT NULL COMMENT '创建人ID',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`announcement_id`),

 KEY `idx_announcement_type` (`announcement_type`),

 KEY `idx_target_type` (`target_type`),

 KEY `idx_start_time` (`start_time`),

 KEY `idx_end_time` (`end_time`),

 KEY `idx_status` (`status`),

 KEY `idx_is_top` (`is_top`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='系统公告表';

#### 7.8 轮播图表（tb_banner）

CREATE TABLE `tb_banner` (

 `banner_id` bigint NOT NULL AUTO_INCREMENT COMMENT '轮播图ID',

 `banner_title` varchar(100) DEFAULT NULL COMMENT '轮播图标题',

 `banner_image` varchar(255) NOT NULL COMMENT '轮播图片URL',

 `banner_url` varchar(255) DEFAULT NULL COMMENT '跳转链接',

 `target_type` tinyint DEFAULT NULL COMMENT '跳转类型：1-内部页面，2-外部链接，3-活动页面',

 `target_id` varchar(64) DEFAULT NULL COMMENT '目标ID',

 `position` tinyint NOT NULL DEFAULT '1' COMMENT '展示位置：1-首页，2-相亲广场，3-游戏大厅',

 `sort_order` int NOT NULL DEFAULT '0' COMMENT '排序顺序',

 `start_time` datetime NOT NULL COMMENT '开始时间',

 `end_time` datetime NOT NULL COMMENT '结束时间',

 `status` tinyint NOT NULL DEFAULT '1' COMMENT '状态：0-下线，1-上线',

 `creator_id` bigint NOT NULL COMMENT '创建人ID',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`banner_id`),

 KEY `idx_position` (`position`),

 KEY `idx_sort_order` (`sort_order`),

 KEY `idx_start_time` (`start_time`),

 KEY `idx_end_time` (`end_time`),

 KEY `idx_status` (`status`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='轮播图表';

### 8. 举报与反馈表组

#### 8.1 举报记录表（tb_report）

CREATE TABLE `tb_report` (

 `report_id` bigint NOT NULL AUTO_INCREMENT COMMENT '举报ID',

 `reporter_id` bigint NOT NULL COMMENT '举报人ID',

 `reported_id` bigint NOT NULL COMMENT '被举报人/内容ID',

 `report_type` tinyint NOT NULL COMMENT '举报类型：1-用户，2-动态，3-评论，4-社群',

 `reason_type` tinyint NOT NULL COMMENT '举报原因类型：1-色情低俗，2-广告骚扰，3-政治敏感，4-诈骗，5-其他',

 `reason_desc` varchar(500) DEFAULT NULL COMMENT '举报原因描述',

 `evidence_urls` varchar(1000) DEFAULT NULL COMMENT '证据图片URL（JSON数组）',

 `report_status` tinyint NOT NULL DEFAULT '0' COMMENT '举报状态：0-待处理，1-已处理，2-已驳回',

 `handle_result` varchar(200) DEFAULT NULL COMMENT '处理结果',

 `handler_id` bigint DEFAULT NULL COMMENT '处理人ID',

 `handle_time` datetime DEFAULT NULL COMMENT '处理时间',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`report_id`),

 KEY `idx_reporter_id` (`reporter_id`),

 KEY `idx_reported_id` (`reported_id`,`report_type`),

 KEY `idx_report_status` (`report_status`),

 KEY `idx_created_at` (`created_at`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='举报记录表';

#### 8.2 用户反馈表（tb_feedback）

CREATE TABLE `tb_feedback` (

 `feedback_id` bigint NOT NULL AUTO_INCREMENT COMMENT '反馈ID',

 `user_id` bigint NOT NULL COMMENT '用户ID',

 `feedback_type` tinyint NOT NULL COMMENT '反馈类型：1-功能建议，2-体验问题，3-技术故障，4-其他',

 `feedback_content` varchar(1000) NOT NULL COMMENT '反馈内容',

 `contact_info` varchar(100) DEFAULT NULL COMMENT '联系方式',

 `image_urls` varchar(1000) DEFAULT NULL COMMENT '图片URL（JSON数组）',

 `feedback_status` tinyint NOT NULL DEFAULT '0' COMMENT '反馈状态：0-待处理，1-处理中，2-已解决，3-已关闭',

 `reply_content` varchar(500) DEFAULT NULL COMMENT '回复内容',

 `handler_id` bigint DEFAULT NULL COMMENT '处理人ID',

 `handle_time` datetime DEFAULT NULL COMMENT '处理时间',

 `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',

 `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

 PRIMARY KEY (`feedback_id`),

 KEY `idx_user_id` (`user_id`),

 KEY `idx_feedback_type` (`feedback_type`),

 KEY `idx_feedback_status` (`feedback_status`),

 KEY `idx_created_at` (`created_at`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户反馈表';

## 三、数据库关系图

以下是主要表之间的关系：

1. 用户基础信息表(tb_user) 与其他用户相关表是一对一或一对多关系

1. 红娘信息表(tb_matchmaker) 与用户表是一对一关系

1. 用户关注表(tb_follow) 记录用户间的关注关系

1. 牵线申请表(tb_matchmaking_request) 关联用户和红娘

1. 游戏房间表(tb_game_room) 与游戏参与记录表(tb_game_player) 是一对多关系

1. 动态表(tb_moment) 与动态媒体表(tb_moment_media) 是一对多关系

1. 社群表(tb_community) 与社群成员表(tb_community_member) 是一对多关系

## 四、索引设计说明

1. 所有表都设置了主键索引，使用自增长的bigint类型

1. 对于外键关系的字段，如user_id, matchmaker_id等都建立了索引

1. 对于经常用于查询条件的字段，如status, type等都建立了索引

1. 对于需要排序的字段，如created_at, sort_order等也建立了索引

1. 对于唯一性约束的字段，如用户手机号、订单编号等，建立了唯一索引

## 五、数据库优化建议

1. 分表策略：对于高频写入的表（如操作日志、交易记录等），可考虑按时间或ID范围进行分表

1. 读写分离：可设置主从复制，主库负责写操作，从库负责读操作，提高并发性能

1. 缓存策略：对于热点数据（如用户资料、游戏配置等），可使用Redis进行缓存

1. 定期归档：对于历史数据，可定期归档到历史表中，保持主表数据量在合理范围

1. 字段优化：

- 对于大文本字段，如动态内容、反馈内容等，可考虑使用TEXT类型

- 对于JSON格式存储的字段，可使用JSON类型（MySQL 5.7+支持）

- 对于敏感信息，如身份证号、银行卡号等，需进行加密存储

## 六、数据库部署建议

1. 主从架构：搭建MySQL主从复制架构，提高系统可用性

1. 数据备份：设置定时备份策略，包括全量备份和增量备份

1. 监控告警：部署数据库监控系统，对CPU、内存、磁盘空间、慢查询等指标进行监控

1. 安全策略：

- 限制数据库远程访问

- 定期修改数据库密码

- 对敏感操作进行审计

- 设置合理的权限分配

通过以上设计，《聊巴》项目的数据库结构可以有效支持各项核心功能的实现，同时具备良好的扩展性和性能表现。