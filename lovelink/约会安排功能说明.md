# 约会安排功能说明

## 🎯 功能概述

当双方都同意牵线申请后（状态为4），红娘可以为他们安排约会，包括约会时间、地点、类型等详细信息。

## 📋 业务流程

### 1. 牵线申请状态流转
```
1. 申请提交 → 2. 红娘处理 → 3. 目标用户确认 → 4. 双方都同意 → 5. 红娘安排约会 → 6. 约会完成
```

### 2. 约会安排流程
1. **查看待安排约会**：红娘查看状态为4的申请列表
2. **安排约会详情**：设置时间、地点、类型、计划等
3. **双方确认约会**：用户确认是否参加约会
4. **约会执行**：按计划进行约会
5. **约会反馈**：双方提供约会反馈和评分

## 🏗️ 技术实现

### 1. 数据库表结构

**约会安排表 (tb_date_arrangement)**：
- `dateId` - 约会安排ID
- `requestId` - 关联的牵线申请ID
- `matchmakerId` - 红娘ID
- `userId` / `targetUserId` - 约会双方用户ID
- `dateTime` - 约会时间
- `dateLocation` - 约会地点
- `dateType` - 约会类型（1-咖啡厅，2-餐厅，3-电影院，4-其他）
- `datePlan` - 约会计划详情
- `userAConfirm` / `userBConfirm` - 双方确认状态
- `arrangementStatus` - 约会状态（0-待确认，1-已确认，2-已取消，3-已完成）

### 2. 后端API接口

**DateArrangementController**：

1. **GET /date/available-requests** - 获取可安排约会的申请列表
   - 查询状态为4的牵线申请
   - 返回申请详情和用户信息
   - 标识是否已安排约会

2. **POST /date/arrange** - 安排约会
   - 接收约会安排信息
   - 创建约会安排记录
   - 更新申请状态为已完成

3. **GET /date/list** - 获取约会安排列表
   - 查询已安排的约会
   - 返回约会详情和确认状态

### 3. 前端页面

**约会安排页面 (arrange-dates.vue)**：

#### 功能特性：
- **双标签切换**：待安排约会 / 已安排约会
- **用户信息展示**：显示约会双方的头像、昵称
- **约会安排弹窗**：时间选择、地点输入、类型选择
- **状态跟踪**：实时显示约会确认状态

#### 界面设计：
- **渐变背景**：紫色渐变，营造浪漫氛围
- **卡片布局**：每个申请/约会独立卡片
- **状态标识**：不同颜色表示不同状态
- **交互友好**：弹窗表单，选择器组件

## 🎨 用户体验设计

### 1. 视觉设计
- **主色调**：紫色渐变 (#667eea → #764ba2)
- **卡片设计**：白色圆角卡片，阴影效果
- **状态颜色**：
  - 待确认：橙色 (#ffeaa7)
  - 已确认：绿色 (#55efc4)
  - 已取消：红色 (#fab1a0)
  - 已完成：紫色 (#a29bfe)

### 2. 交互设计
- **时间选择器**：日期+时间双列选择
- **地点输入**：文本输入框，支持100字以内
- **类型选择**：下拉选择器（咖啡厅、餐厅、电影院、其他）
- **计划描述**：多行文本框，支持500字以内

### 3. 信息展示
- **用户信息**：头像 + 昵称 + 角色标识
- **申请信息**：申请留言 + 同意时间
- **约会详情**：时间、地点、类型、计划
- **确认状态**：双方确认情况实时更新

## 📱 页面路由配置

在 `pages.json` 中添加：
```json
{
  "path": "pages/matchmaker/arrange-dates",
  "style": {
    "navigationBarTitleText": "约会安排",
    "navigationBarBackgroundColor": "#667eea",
    "navigationBarTextStyle": "white"
  }
}
```

## 🔗 功能扩展

### 1. 约会提醒功能
- 约会前24小时发送提醒通知
- 约会前2小时发送确认通知

### 2. 约会反馈系统
- 约会结束后收集双方反馈
- 评分系统（1-5星）
- 成功率统计

### 3. 约会模板功能
- 预设约会方案模板
- 根据用户喜好推荐约会类型
- 地点推荐系统

### 4. 约会跟踪功能
- 约会进行中状态更新
- GPS定位确认到场
- 约会时长记录

## 🎯 业务价值

### 1. 提升服务质量
- 专业的约会安排服务
- 个性化的约会方案
- 全程跟踪服务

### 2. 增加用户粘性
- 完整的服务闭环
- 贴心的服务体验
- 提高成功率

### 3. 数据价值
- 约会偏好数据收集
- 成功率分析
- 服务质量评估

## 🚀 使用方法

### 红娘操作流程：
1. 登录红娘账号
2. 进入"约会安排"页面
3. 查看"待安排约会"列表
4. 点击"安排约会"按钮
5. 填写约会详情信息
6. 确认安排，等待双方确认

### 用户确认流程：
1. 收到约会安排通知
2. 查看约会详情
3. 确认或拒绝约会
4. 参加约会
5. 提供约会反馈

这个约会安排功能为整个牵线服务提供了完整的闭环体验，让红娘能够专业地为用户安排约会，提升服务质量和用户满意度。
